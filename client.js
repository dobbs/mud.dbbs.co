/*! wiki-client - v0.23.2 - 2022-01-06
 * Copyright 2022 Ward Cunningham and other contributors;
 * Released under the MIT license */
!function r(o,i,a){function u(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return u(o[e][1][t]||t)},n,n.exports,r,o,i,a)}return i[e].exports}for(var c="function"==typeof require&&require,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){"use strict";console.log("Window Name: "+window.name),window.name=window.location.host,window.wiki=t("./lib/wiki"),t("./lib/legacy"),t("./lib/bind"),t("./lib/plugins")},{"./lib/bind":5,"./lib/legacy":14,"./lib/plugins":24,"./lib/wiki":38}],2:[function(t,e,n){"use strict";var r={create:"☼",add:"+",edit:"✎",fork:"⚑",move:"↕",remove:"✕"};e.exports={symbols:r,fork:r.fork,add:r.add}},{}],3:[function(t,e,n){"use strict";var c,s,r;e.exports=c={},c.scrollContainer=void 0,s=function(){var t=$("body, html").filter(function(){return 0<$(this).scrollLeft()});return 0<t.length?t:$("body, html").scrollLeft(12).filter(function(){return 0<$(this).scrollLeft()}).scrollTop(0)},r=function(t){var e,n,r,o,i,a,u;if(null!=t.position())return null==c.scrollContainer&&(c.scrollContainer=s()),e=$("body").width(),r=(o=c.scrollContainer.scrollLeft())+e,a=t.position().left,u=t.outerWidth(!0),n=$(".page").outerWidth(!0)*$(".page").length,a<o?i=a:r<a+u?i=a-(e-u):r>$(".pages").outerWidth()&&(i=Math.min(a,n-e)),c.scrollContainer.animate({scrollLeft:i},function(){if(!$.contains(t[0],document.activeElement))return t.focus()})},c.set=function(t,e){if($(".incremental-search").remove(),t=$(t),$(".active").removeClass("active"),t.addClass("active"),!e)return r(t)}},{}],4:[function(t,e,n){"use strict";var i=t("./util"),a=t("./actionSymbols");e.exports=function(t,e){var n,r=t.parents(".page:first"),o="";if(null!=e.site&&(o+="".concat(e.site,"\n")),o+=e.type||"separator",null!=e.date&&(o+=" ".concat(i.formatElapsedTime(e.date))),n=$('<a href="#" /> ').addClass("action").addClass(e.type||"separator").text(e.symbol||a.symbols[e.type]).attr("title",o).attr("data-id",e.id||"0").data("action",e),0<(o=t.children(".control-buttons")).length?n.insertBefore(o):n.appendTo(t),"fork"===e.type&&null!=e.site)return n.css("background-image","url(".concat(wiki.site(e.site).flag())).attr("href","".concat(wiki.site(e.site).getDirectURL(r.attr("id")),".html")).attr("target","".concat(e.site)).data("site",e.site).data("slug",r.attr("id"))}},{"./actionSymbols":2,"./util":37}],5:[function(t,e,n){"use strict";var r=t("./neighborhood"),o=t("./neighbors"),i=t("./searchbox"),a=t("./state"),u=t("./link");$(function(){return i.inject(r),i.bind(),o.inject(r),o.bind(),window.seedNeighbors&&seedNeighbors.split(",").forEach(function(t){return r.registerNeighbor(t.trim())}),a.inject(u)})},{"./link":17,"./neighborhood":18,"./neighbors":19,"./searchbox":31,"./state":34}],6:[function(t,e,n){"use strict";var r=t("./resolve"),o=null;e.exports={emit:function(){return o=$("<div></div>").html("This dialog will show every time!").dialog({autoOpen:!1,title:"Basic Dialog",height:600,width:800})},open:function(t,e){return o.html(e),o.dialog("option","title",r.resolveLinks(t)),o.dialog("open")}}},{"./resolve":28}],7:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=[].indexOf,a=t("url"),u=function(t){return null!=(t=t.originalEvent.dataTransfer)&&0<=i.call(t.types,"Files")?t.files[0]:null},c=function(t){var e;return null!=(t=t.originalEvent.dataTransfer)&&null!=t.types&&(0<=i.call(t.types,"text/uri-list")||0<=i.call(t.types,"text/x-moz-url"))&&null!=(e=t.getData("URL"))&&e.length?e:null},s=function(t){if(n=t.match(/^https?:\/\/([a-zA-Z0-9:.-]+)(\/([a-zA-Z0-9:.-]+)\/([a-z0-9-]+(_rev\d+)?))+$/)){var e={},t=r(n,6),n=(t[0],t[1]);return t[2],e.site=t[3],e.slug=t[4],t[5],"view"!==(t=e.site)&&"local"!==t&&"origin"!==t||(e.site=n),e}return null},l=function(t){return a.parse(t,!0,!0).pathname.match(/\.(jpg|jpeg|png|svg)$/i)?t:null},f=function(t){var e=a.parse(t,!0,!0);try{"video"===e.query.source&&(e=a.parse(e.query.url,!0,!0))}catch(t){0}switch(e.hostname){case"www.youtube.com":return null!=e.query.list?{text:"YOUTUBE PLAYLIST ".concat(e.query.list)}:{text:"YOUTUBE ".concat(e.query.v)};case"youtu.be":return null!=e.query.list?{text:"YOUTUBE PLAYLIST ".concat(e.query.list)}:{text:"YOUTUBE ".concat(e.pathname.substr(1))};case"vimeo.com":return{text:"VIMEO ".concat(e.pathname.substr(1))};case"archive.org":return{text:"ARCHIVE ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};case"tedxtalks.ted.com":return{text:"TEDX ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};case"www.ted.com":return{text:"TED ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};default:return null}};e.exports={dispatch:function(i){return function(e){var t,n,r,o=function(t){return e.preventDefault(),e.stopPropagation()};if(n=c(e)){if((r=s(n))&&null!=(t=i.page))return o(t(r));if((r=f(n))&&null!=(t=i.video))return o(t(r));if((r=l(n))&&null!=(t=i.image))return o(t(r));r={url:n}}if(n=u(e)){if(null!=(t=i.file))return o(t(n));r={file:n}}if(null!=(t=i.punt))return o(t(r=r||{dt:e.dataTransfer,types:null!=(t=e.dataTransfer)?t.types:void 0}))}}}},{url:57}],8:[function(t,e,n){"use strict";var o=t("./plugin"),f=t("./itemz"),i=t("./pageHandler"),d=t("./link"),a=t("./random"),h=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},p=function(a,u){var c,s,t,e,n,r,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(console.log("textEditor",u.id,l),"markdown"===u.type&&(s=0),$(".editEnable").is(":visible")&&(e=function(t){var e,n,r,o,i;return 27===t.which||(t.ctrlKey||t.metaKey)&&83===t.which?(t.preventDefault(),c.focusout(),!1):(t.ctrlKey||t.metaKey)&&73===t.which?(t.preventDefault(),t.shiftKey||(e=$(t.target).parents(".page")),d.doInternalLink("about ".concat(u.type," plugin"),e),!1):(t.ctrlKey||t.metaKey)&&77===t.which?(t.preventDefault(),a.removeClass(u.type).addClass(u.type="factory"),c.focusout(),!1):"paragraph"===u.type||"markdown"===u.type?(r=v(c),t.which===$.ui.keyCode.BACKSPACE&&0===r.start&&r.start===r.end?(e=a.prev(),(n=f.getItem(e)).type!==u.type||(i=n[l.field||"text"].length,o=c.val(),c.val(""),p(e,n,{caret:i,suffix:o})),!1):t.which===$.ui.keyCode.ENTER?!!r&&("markdown"===u.type&&s++,"paragraph"===u.type||"markdown"===u.type&&2===s?(n=a.parents(".page"),t=(i=c.val()).substring(0,r.start),o=i.substring(r.end),""===t?(c.val(o),c.focusout(),g(n,a.prev(),u.type,t)):(c.val(t),c.focusout(),g(n,a,u.type,o)),!1):void 0):"markdown"===u.type?s=0:void 0):void 0},t=function(){var t;if(a.removeClass("textEditing"),c.unbind(),t=a.parents(".page:first"),u[l.field||"text"]=c.val())if(a.removeClass("output-item"),a.removeClass(function(t,e){return(e.match(/\S+-source/)||[]).join(" ")}),o.do(a.empty(),u),l.after){if(""===u[l.field||"text"])return;i.put(t,{type:"add",id:u.id,item:u,after:l.after})}else{if(u[l.field||"text"]===n)return;i.put(t,{type:"edit",id:u.id,item:u})}else l.after||i.put(t,{type:"remove",id:u.id}),t=$(".item").index(a),a.remove(),o.renderFrom(t);return null},!a.hasClass("textEditing")))return a.addClass("textEditing"),a.unbind(),n=null!=(r=u[l.field||"text"])?r:"",c=$("<textarea>".concat(h(n)).concat(h(null!=(r=l.suffix)?r:""),"</textarea>")).focusout(t).bind("keydown",e),a.html(c),l.caret?m(c,l.caret):l.append?(m(c,c.val().length),c.scrollTop(c[0].scrollHeight-c.height())):c.focus()},g=function(t,e,n,r){n={type:n,id:a.itemId(),text:r},r=$('<div class="item '.concat(n.type,'" data-id=').concat(n.id,"></div>"));return r.data("item",n).data("pageElement",t),e.after(r),e=f.getItem(e),p(r,n,{after:null!=e?e.id:void 0})},v=function(t){var e=t.get(0);return document.selection?(e.focus(),(t=document.selection.createRange()).moveStart("character",-e.value.length),{start:t=t.text.length,end:t}):{start:e.selectionStart,end:e.selectionEnd}},m=function(t,e){var n=t.get(0);if(null!=n)return n.createTextRange?((t=n.createTextRange()).move("character",e),t.select()):n.setSelectionRange(e,e),n.focus()};e.exports={textEditor:p}},{"./itemz":13,"./link":17,"./pageHandler":21,"./plugin":23,"./random":25}],9:[function(t,e,n){"use strict";function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=t("./neighborhood"),l=t("./plugin"),o=t("./resolve"),f=t("./pageHandler"),d=t("./editor"),h=t("./synopsis"),p=t("./drop"),g=t("./active"),i=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")},v=function(t,e){var n,r,o,i;for(e=e||",",o=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),n=[[]],r=null;r=o.exec(t);)(i=r[1]).length&&i!==e&&n.push([]),i=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(i);return n},m=function(t){for(var e,u=t.shift(),n=function(t){for(var e={},n=_.zip(u,t),r=0,o=n.length;r<o;r++){var i=c(n[r],2),a=i[0];null!=(i=i[1])&&i.match(/\S/)&&"NULL"!==i&&(e[a]=i)}return e},r=[],o=0,i=t.length;o<i;o++)e=t[o],r.push(n(e));return r},y=function(t){var n=function(t){var e="";return[].slice.call(new Uint8Array(t)).forEach(function(t){return e+=String.fromCharCode(t)}),window.btoa(e)};return fetch(t).then(function(t){if(t.ok)return t;throw new Error("Unable to fetch image")}).then(function(t){return t.arrayBuffer().then(function(t){var e="data:image/jpeg;base64,";return e+=n(t)})}).catch(function(t){return console.log("Unable to fetch remote image")})},b=function(r){var o=new Image,i=void 0,a=void 0,u=function(t){return t.width<=500||t.height<=300};return new Promise(function(t){return o.src=r,o.onload=function(){return t()}}).then(function(){return i=o.naturalWidth,a=o.naturalHeight}).then(function(){var t,e;if(!u(o))return t=Math.max(1,Math.min(i/500,a/300)),e=Math.floor(Math.log2(t)),e=t/Math.pow(2,e),i=Math.round(i/e),a=Math.round(a/e)}).then(function(){return new Promise(function(e){var n=new Image;return n.src=o.src,n.onload=function(){var t;return u(n)?e(r):((t=document.createElement("canvas")).width=i,t.height=a,t.getContext("2d").drawImage(n,0,0,i,a),r=t.toDataURL("image/jpeg",.5),i/=2,a/=2,n.src=r)}})}).then(function(){return r})};e.exports={emit:function(a,u){var n;return a.append("<p>Double-Click to Edit<br>Drop Text or Image to Insert</p>"),n=function(){for(var t,e,n=a.find("p").append('<br>Or Choose a Plugin\n<center>\n<table style="text-align:left;">\n<tr><td><ul id=format><td><ul id=data><td><ul id=other>'),r=window.catalog,o=0,i=r.length;o<i;o++)(e=r[o])&&e.category&&("format"!==(t=e.category)&&"data"!==t&&(t="other"),n.find("#"+t).append('<li><a class="menu" href="#" title="'.concat(e.title,'">').concat(e.name,"</a></li>")));return n.find("a.menu").click(function(t){var e=t.target.text,n=e.toLowerCase();if(a.removeClass("factory").addClass(u.type=n),a.unbind(),t.preventDefault(),g.set(a.parents(".page")),!window.catalog.find(function(t){return e===t.name}).editor)return d.textEditor(a,u);try{return window.plugins[n].editor(a,u)}catch(t){return n=t,console.log("".concat(e," Plugin editor failed: ").concat(n,". Falling back to textEditor")),d.textEditor(a,u)}})},u.prompt?function(){return a.append("<p>".concat(o.resolveLinks(u.prompt,i),"</b>"))}():null!=window.catalog?n():wiki.origin.get("system/factories.json",function(t,e){return console.log("factory",e),window.catalog=e,n()})},bind:function(e,o){var i=function(){var t;e.empty().unbind(),e.removeClass("factory").addClass(o.type),t=e.parents(".page:first");try{e.data("pageElement",t),e.data("item",o),l.getPlugin(o.type,function(t){return t.emit(e,o),t.bind(e,o)})}catch(t){e.append("<p class='error'>".concat(t,"</p>"))}return f.put(t,{type:"edit",id:o.id,item:o})},a=function(t){return o.prompt="Unexpected Item\nWe can't make sense of the drop.\nTry something else or see [[About Factory Plugin]].",t.userAgent=navigator.userAgent,o.punt=t,i()},t=function(n){return wiki.site(n.site).get("".concat(n.slug,".json"),function(t,e){if(!t&&(o.type="reference",o.site=n.site,o.slug=n.slug,o.title=e.title||n.slug,o.text=h(e),i(),null!=o.site))return s.registerNeighbor(o.site)})},n=function(t){return o.type="video",o.text="".concat(t.text,"\n(double-click to edit caption)\n"),i()},r=function(e){return document.documentElement.style.cursor="wait",y(e).then(function(t){return b(t)}).then(function(t){return document.documentElement.style.cursor="default",o.type="image",o.url=t,o.source=e,o.caption||(o.caption="Remote image"),i()})},u=function(n){if(null!=n){var t=c(n.type.split("/"),2),e=t[0],r=t[1],t=new FileReader;return"image"===e?(t.onload=function(t){return b(t.target.result).then(function(t){return o.type="image",o.url=t,o.caption||(o.caption="Uploaded image"),i()})},t.readAsDataURL(n)):"text"===e?(t.onload=function(t){var e=t.target.result;return"csv"===r?(o.type="data",o.columns=(t=v(e))[0],o.data=m(t),o.text=n.fileName):(o.type="paragraph",o.text=e),i()},t.readAsText(n)):a({name:n.name,type:n.type,size:n.size,fileName:n.fileName,lastModified:n.lastModified})}};return e.dblclick(function(t){return t.shiftKey?d.textEditor(e,o,{field:"prompt"}):(e.removeClass("factory").addClass(o.type="paragraph"),e.unbind(),d.textEditor(e,o))}),e.bind("dragenter",function(t){return t.preventDefault()}),e.bind("dragover",function(t){return t.preventDefault()}),e.bind("drop",p.dispatch({page:t,file:u,video:n,image:r,punt:a}))}}},{"./active":3,"./drop":7,"./editor":8,"./neighborhood":18,"./pageHandler":21,"./plugin":23,"./resolve":28,"./synopsis":35}],10:[function(t,e,n){"use strict";var c=t("./resolve"),s=t("./neighborhood"),i=t("./lineup"),a=t("./refresh");e.exports={emit:function(t,e){var n,r,o,i,a,u;if(t.append("".concat(e.text,'<br><br><button class="create">create</button> new blank page')),(u=null!=(o=e.create)&&null!=(u=o.source)?u.transport:void 0)&&(t.append('<br><button class="transport" data-slug='.concat(e.slug,">create</button> transport from ").concat(u)),t.append("<p class=caption> unavailable</p>"),$.get("//localhost:4020",function(){return t.find(".caption").text("ready")})),null!=(u=s.sites[location.host])&&null!=u.sitemap){for(a=[],n=0,r=(i=u.sitemap).length;n<r;n++)(e=i[n]).slug.match(/-template$/)?a.push(t.append('<br><button class="create" data-slug='.concat(e.slug,">create</button> from ").concat(c.resolveLinks("[[".concat(e.title,"]]"))))):a.push(void 0);return a}},bind:function(o,n){return o.find("button.transport").click(function(t){var e;return o.find(".caption").text("waiting"),e={title:o.parents(".page").data("data").title,create:n.create},e={type:"POST",url:n.create.source.transport,dataType:"json",contentType:"application/json",data:JSON.stringify(e)},$.ajax(e).done(function(t){var e,n,r;return o.find(".caption").text("ready"),r=wiki.newPage(t),e=o.parents(".page"),(n=i.atKey(e.data("key"))).become(r,r),t=n.getRawPage(),a.rebuildPage(n,e.empty())})})}}},{"./lineup":16,"./neighborhood":18,"./refresh":27,"./resolve":28}],11:[function(t,e,n){"use strict";var r=t("./dialog"),o=t("./editor"),i=t("./resolve"),a=!1,u=!1,c=function(){return u=!0,$.ajax("".concat("http://127.0.0.1:8080","/ipfs/Qmb1oS3TaS8vekxXqogoYsixe47sXcVxQ22kPWH8VSd7yQ"),{timeout:3e4,success:function(t){return a="wiki\n"===t},complete:function(t,e){return console.log("ipfs gateway ".concat(e))}})};e.exports={emit:function(t,e){return e.text||(e.text=e.caption),t.append('<img class=thumbnail src="'.concat(e.url,'"> <p>').concat(i.resolveLinks(e.text),"</p>"))},bind:function(t,e){return t.dblclick(function(){return o.textEditor(t,e)}),e.ipfs&&!u&&c(),t.find("img").dblclick(function(t){return t.stopPropagation(),t=a&&null!=e.ipfs?"".concat(gateway,"/ipfs/").concat(e.ipfs):null!=e.source?e.source:e.url,r.open(e.text,'<img style="width:100%" src="'.concat(t,'">'))})}}},{"./dialog":6,"./editor":8,"./resolve":28}],12:[function(t,e,n){"use strict";var a=t("./util"),o=t("./link"),i=t("./page").newPage,u=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};e.exports={emit:function(t,e){return t.append('<p style="background-color:#eee;padding:15px;">\n  '.concat(function(t){var e,n,r,o,i=[];for(o in t)r=t[o],n="<a href=".concat(o,">").concat(u(r.title)||o,"</a>"),r.journal&&((e=r.journal[r.journal.length-1].date)?n+=" &nbsp; from ".concat(a.formatElapsedTime(e)):n+=" &nbsp; from revision ".concat(r.journal.length-1)),i.push(n);return i.join("<br>")}(e.pages),"\n</p>"))},bind:function(t,r){return t.find("a").click(function(t){var e,n=$(t.target).attr("href");return t.shiftKey||(e=$(t.target).parents(".page")),n=i(r.pages[n]),o.showResult(n,{$page:e,rev:n.getRevision()}),!1})}}},{"./link":17,"./page":20,"./util":37}],13:[function(t,e,n){"use strict";var i=t("./pageHandler"),a=t("./plugin"),u=t("./random"),c=function(t,e){return setTimeout(e,t)},s=function(t){if(0<$(t).length)return $(t).data("item")||$(t).data("staticItem")};e.exports={createItem:function(t,e,n){var r,o;return null==t&&(t=e.parents(".page")),n.id=u.itemId(),(r=$('<div class="item '.concat(n.type,'" data-id=""</div>'))).data("item",n).data("pageElement",t),null!=e?e.after(r):t.find(".story").append(r),a.do(r,n),o=s(e),c(500,function(){return i.put(t,{item:n,id:n.id,type:"add",after:null!=o?o.id:void 0})}),r},removeItem:function(t,e){return i.put(t.parents(".page:first"),{type:"remove",id:e.id}),t.remove()},getItem:s,replaceItem:function(e,t,n){var r=$.extend({},n);e.empty().unbind(),e.removeClass(t).addClass(r.type),t=e.parents(".page:first");try{e.data("pageElement",t),e.data("item",r),a.getPlugin(n.type,function(t){return t.emit(e,r),t.bind(e,r)})}catch(t){e.append("<p class='error'>".concat(t,"</p>"))}return i.put(t,{type:"edit",id:r.id,item:r})}}},{"./pageHandler":21,"./plugin":23,"./random":25}],14:[function(t,e,n){"use strict";var u=t("./pageHandler"),c=t("./state"),s=t("./active"),f=t("./refresh"),d=t("./lineup"),h=t("./drop"),p=t("./dialog"),g=t("./link"),v=t("./target"),m=t("./license"),y=t("./plugin"),b=t("./page").asSlug,w=t("./page").newPage,r=function(t){return t.filter(function(t){return t.editor}).forEach(function(e){return console.log("".concat(e.name," Plugin declares an editor, so pre-loading the plugin")),wiki.getPlugin(e.name.toLowerCase(),function(t){if(!t.editor||"function"!=typeof t.editor)return console.log("".concat(e.name,' Plugin ERROR.\nCannot find `editor` function in plugin. Set `"editor": false` in factory.json or\nCorrect the plugin to include all three of `{emit, bind, editor}`'))})})};wiki.origin.get("system/factories.json",function(t,e){return window.catalog=e,r(e)}),$(function(){var r,o,i,l,t,a,e;return p.emit(),$(document).keydown(function(t){var e,n,r=function(){switch(t.which){case 37:return-1;case 39:return 1}}();if(r&&!$(t.target).is(":input")&&0<=(e=(n=$(".page")).index($(".active"))+r)&&e<n.length&&s.set(n.eq(e)),(t.ctrlKey||t.metaKey)&&83===t.which)return t.preventDefault(),$("input.search").focus()}),$(window).on("popstate",c.show),$(document).ajaxError(function(t,e,n){if(0!==e.status&&404!==e.status)return console.log("ajax error",t,e,n)}),r=function(t){return"".concat(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},e=function(n){var t;if("application/json"===(null!=n?n.type:void 0))return(t=new FileReader).onload=function(t){var e=t.target.result,t=JSON.parse(e),e=w();return e.setTitle("Import from ".concat(n.name)),e.addParagraph("Import of ".concat(Object.keys(t).length," pages\n(").concat(r(n.size)," bytes)\nfrom an export file dated ").concat(n.lastModifiedDate,".")),e.addItem({type:"importer",pages:t}),g.showResult(e)},t.readAsText(n)},o=function(e,n){return console.log("fork to delete"),u.delete(e,n,function(t){if(null==t)return console.log("server delete successful"),e.isRecycler()||(t=f.newFuturePage(e.getTitle(),e.getCreate()),e.become(t),n.attr("id",t.getSlug()),f.rebuildPage(e,n)),n.addClass("ghost")})},t=function(t,n){return t?(console.log("getTemplate",t),u.get({whenGotten:function(t,e){return n(t)},whenNotGotten:function(){return n(null)},pageInformation:{slug:t}})):n(null)},i=function(t,e){var n;return t.preventDefault(),t.shiftKey||(n=$(t.target).parents(".page")),g.doInternalLink(e,n,$(t.target).data("site")),!1},a=null,$(".main").sortable({handle:".page-handle",cursor:"grabbing"}).on("sortstart",function(t,e){if(e.item.hasClass("page"))return s.set(e.item,!0),a=$(".page").index(e.item[0])}).on("sort",function(t,e){if(e.item.hasClass("page"))return e=e.item,t.pageY<0&&2<$(".page").length?e.addClass("pending-remove"):e.removeClass("pending-remove")}).on("sortstop",function(t,e){var n,r,o;if(e.item.hasClass("page")){if(n=e.item,o=(r=$(".page")).index($(".active")),e=$(".item").index(n.find(".item")[0]),n.hasClass("pending-remove")){if(1===r.length)return;d.removeKey(n.data("key")),n.remove(),s.set($(".page")[o])}else d.changePageIndex(n.data("key"),o),s.set($(".active")),a<o&&(o=a,e=$(".item").index($($(".page")[o]).find(".item")[0]));return y.renderFrom(e),c.setUrl(),c.debugStates()}}).delegate(".show-page-license","click",function(t){var e;return t.preventDefault(),t=(e=$(this).parents(".page")).find("h1").text().trim(),p.open("License for ".concat(t),m.info(e))}).delegate(".show-page-source","click",function(t){return t.preventDefault(),t=$(this).parents(".page"),t=d.atKey(t.data("key")).getRawPage(),p.open("JSON for ".concat(t.title),$("<pre/>").text(JSON.stringify(t,null,2)))}).delegate(".page","click",function(t){if(!$(t.target).is("a"))return s.set(this)}).delegate(".internal","click",function(t){var e=$(t.target),e=e.text()||e.data("pageName");return e="".concat(e),u.context=$(t.target).attr("title").split(" => "),i(t,e)}).delegate("img.remote","click",function(t){var e;return $(t.target).attr("src").startsWith("data:image/png")?(t.preventDefault(),e=$(t.target).data("site"),wiki.site(e).refresh(function(){})):(e=$(t.target).data("slug"),u.context=[$(t.target).data("site")],i(t,e))}).delegate(".revision","dblclick",function(t){var e,n;return t.preventDefault(),e=$(this).parents(".page"),t=(n=d.atKey(e.data("key")).getRawPage()).journal.length-1,e=n.journal[t],n=JSON.stringify(e,null,2),p.open("Revision ".concat(t,", ").concat(e.type," action"),$("<pre/>").text(n))}).delegate(".action","click",function(t){var e,n,r,o;return t.preventDefault(),(r=$(t.target)).is(".fork")&&null!=(o=r.data("slug"))?(u.context=[r.data("site")],i(t,o.split("_")[0])):(n=(e=$(this).parents(".page")).data("key"),o=d.atKey(n).getSlug(),(r=$(this).parent().children().not(".separator").index(r))<0?void 0:(t.shiftKey||e.nextAll().remove(),t.shiftKey||d.removeAllAfterKey(n),g.createPage("".concat(o,"_rev").concat(r),e.data("site")).appendTo($(".main")).each(function(t,e){return f.cycle($(e))}),s.set($(".page").last())))}).delegate(".fork-page","click",function(t){var e,n=$(t.target).parents(".page");if(!n.find(".future").length){if(e=d.atKey(n.data("key")),n.attr("id").match(/_rev0$/))return o(e,n);if(t={type:"fork"},n.hasClass("local")){if(u.useLocalStorage())return;n.removeClass("local")}else e.isRecycler()?n.removeClass("recycler"):e.isRemote()&&(t.site=e.getRemoteSite());return null!=n.data("rev")&&n.find(".revision").remove(),n.removeClass("ghost"),u.put(n,t)}}).delegate("button.create","click",function(r){return t($(r.target).data("slug"),function(t){var e,n=$(r.target).parents(".page:first");return n.removeClass("ghost"),(e=d.atKey(n.data("key"))).become(t),t=e.getRawPage(),f.rebuildPage(e,n.empty()),u.put(n,{type:"create",id:t.id,item:{title:t.title,story:t.story}})})}).delegate(".score","mouseenter mouseleave",function(t){return console.log("in .score..."),$(".main").trigger("thumb",$(t.target).data("thumb"))}).delegate("a.search","click",function(t){var o,e=$(t.target).parents(".page"),n=e.data("key"),i=d.atKey(n),r=w();return r.setTitle("Search from '".concat(i.getTitle(),"'")),r.addParagraph("Search for pages related to '".concat(i.getTitle(),"'.\nEach search on this page will find pages related in a different way.\nChoose the search of interest. Be patient.")),r.addParagraph("Find pages with links to this title."),r.addItem({type:"search",text:"SEARCH LINKS ".concat(i.getSlug())}),r.addParagraph("Find pages with titles similar to this title."),r.addItem({type:"search",text:"SEARCH SLUGS ".concat(i.getSlug())}),r.addParagraph("Find pages neighboring  this site."),r.addItem({type:"search",text:"SEARCH SITES ".concat(i.getRemoteSite(location.host))}),r.addParagraph("Find pages sharing any of these items."),r.addItem({type:"search",text:"SEARCH ANY ITEMS ".concat(function(){for(var t=i.getRawPage().story,e=[],n=0,r=t.length;n<r;n++)o=t[n],e.push(o.id);return e}().join(" "))}),t.shiftKey||e.nextAll().remove(),t.shiftKey||d.removeAllAfterKey(n),g.showResult(r)}).bind("dragenter",function(t){return t.preventDefault()}).bind("dragover",function(t){return t.preventDefault()}).bind("drop",h.dispatch({page:function(t){return g.doInternalLink(t.slug,null,t.site)},file:e})),$(".provider input").click(function(){return $("footer input:first").val($(this).attr("data-provider")),$("footer form").submit()}),$("body").on("new-neighbor-done",function(t,e){return $(".page").each(function(t,e){return f.emitTwins($(e))})}),l=function(o){return new Promise(function(n,t){var r=b(o);return wiki.origin.get("".concat(r,".json"),function(t,e){return n({title:o,slug:r,type:"reference",text:(t?t.msg:null!=e?e.story[0].text:void 0)||""})})})},$("<span>&nbsp; ☰ </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){var t,e,n,r,o,i,a,u,c,s=w();if(s.setTitle("Selected Plugin Pages"),s.addParagraph("Installed plugins offer these utility pages:"),window.catalog){for(c=[],t=0,r=(i=window.catalog).length;t<r;t++)if((e=i[t]).pages)for(n=0,o=(a=e.pages).length;n<o;n++)u=a[n],c.push(u);return Promise.all(c.map(l)).then(function(t){return t.forEach(function(t){return s.addItem(t)}),g.showResult(s)})}}),$("<span>&nbsp; wiki <span class=editEnable>✔︎</span> &nbsp; </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){return $(".editEnable").toggle(),$(".page").each(function(){var t=$(this),e=d.atKey(t.data("key"));return f.rebuildPage(e,t.empty())})}),isAuthenticated||$(".editEnable").toggle(),v.bind(),$(function(){var t,n;return c.first(),t=$(".page").toArray(),(n=function(t){var e;if(0!==t.length)return e=$(t.shift()),f.cycle(e).then(function(){return n(t)});s.set($(".page").last())})(t)})})},{"./active":3,"./dialog":6,"./drop":7,"./license":15,"./lineup":16,"./link":17,"./page":20,"./pageHandler":21,"./plugin":23,"./refresh":27,"./state":34,"./target":36}],15:[function(t,e,n){"use strict";var r=t("./resolve"),o=t("./lineup"),i=function(){return'<p>\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>\n</p><p>\n  This work is licensed under a\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n    Creative Commons Attribution-ShareAlike 4.0 International License\n  </a>.\n</p><p>\n  This license applies uniformly to all contributions\n  by all authors. Where authors quote other sources\n  they do so within the terms of fair use or other\n  compatiable terms.\n</p>'},a=function(t,e){var n,r,o,i,a,u,c;if(null==t.journal)return"";for(n={},i=[],o=(a=t.journal.slice(r=0).reverse()).length;r<o;r++)null!=(u=a[r]).site&&(e=u.site),"fork"!==u.type&&null==n[e]&&(c=wiki.site(e).getDirectURL(""),u=wiki.site(e).flag(),i.push('<a href="'.concat(c,'" target="_blank"><img class="remote" title="').concat(e,'" src="').concat(u,'"> ').concat(e,"</a>")),n[e]=!0);return 0<i.length?"<p>\n  Author's Sites:\n</p><p>\n  ".concat(i.join("<br>"),"\n</p>"):""},u=function(t){return null==(null!=t?t.provenance:void 0)?"":"<p>\n  Created From:\n</p><p>\n  ".concat(r.resolveLinks(t.provenance),"\n</p>")};e.exports={info:function(t){var e=o.atKey(t.data("key")),t=e.getRawPage(),e=e.getRemoteSite(location.hostname);return i()+a(t,e)+u(t.journal[0])}}},{"./lineup":16,"./resolve":28}],16:[function(t,e,n){"use strict";var r=[].indexOf,o=t("./random"),a={},i=[],u=function(t){return a[t]},c=function(t){return u(t).getTitle()},s=function(t){t=i.indexOf(t);return t<1?null:i[t-1]};e.exports={addPage:function(t){var e=o.randomBytes(4);return a[e]=t,i.push(e),e},changePageIndex:function(t,e){var n=i.indexOf(t);return i.splice(n,1),i.splice(e,0,t)},removeKey:function(e){return r.call(i,e)<0?null:(i=i.filter(function(t){return e!==t}),delete a[e],e)},removeAllAfterKey:function(t){var e,n=[];if(r.call(i,t)<0)return n;for(;i[i.length-1]!==t;)e=i.pop(),n.unshift(e),delete a[e];return n},atKey:u,titleAtKey:c,bestTitle:function(){return i.length?c(i[i.length-1]):"Wiki"},debugKeys:function(){return i},debugReset:function(){return a={},i=[]},crumbs:function(t,e){var n,r,o=a[t],i=o.getRemoteSite(e),o=["view",r=o.getSlug()];return"welcome-visitors"!==r&&o.unshift("view","welcome-visitors"),i!==e&&null!=(n=s(t))&&((n=a[n]).isRemote()||o.push(e,n.getSlug())),o.unshift(i),o},debugSelfCheck:function(t){if("".concat(i)!=="".concat(t)&&(console.log("The lineup is out of sync with the dom."),console.log(".pages:",t),console.log("lineup:",i),"".concat(Object.keys(i).sort())==="".concat(Object.keys(t).sort())))return console.log("It looks like an ordering problem we can fix."),t}}},{"./random":25}],17:[function(t,e,n){"use strict";var o=t("./lineup"),i=t("./active"),r=t("./refresh"),a=t("./page"),u=a.asTitle,c=a.asSlug,t=a.pageEmitter,s=function(t,e){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e&&"view"!==e&&(n=e),r=r||u(t),r=$('<div class="page" id="'.concat(t,'" tabindex="-1">\n  <div class="paper">\n    <div class="twins"> <p> </p> </div>\n    <div class="header">\n      <h1> <img class="favicon" src="').concat(wiki.site(n).flag(),'" height="32px"> ').concat(r," </h1>\n    </div>\n  </div>\n</div>")),n&&r.data("site",n),r},l=function(t,e){return s(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null).appendTo(".main").each(function(t,e){return r.cycle($(e))})},a=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=c(t);return null!=e&&$(e).nextAll().remove(),null!=e&&o.removeAllAfterKey($(e).data("key")),l(r,n,t),i.set($(".page").last())},f=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return null!=n.$page&&$(n.$page).nextAll().remove(),null!=n.$page&&o.removeAllAfterKey($(n.$page).data("key")),e=t.getSlug(),null!=n.rev&&(e+="_rev".concat(n.rev)),(e=s(e).addClass("ghost")).appendTo($(".main")),r.buildPage(t,e),i.set($(".page").last())};t.on("show",function(t){return console.log("pageEmitter handling",t),f(t)}),e.exports={createPage:s,doInternalLink:a,showPage:l,showResult:f}},{"./active":3,"./lineup":16,"./page":20,"./refresh":27}],18:[function(t,e,n){"use strict";var i,h,a,r,p={}.hasOwnProperty,o=t("underscore"),g=t("minisearch");e.exports=h={},h.sites={},a=0,r=function(n,r){var t,e,o;if(!r.sitemapRequestInflight)return r.sitemapRequestInflight=!0,o=function(t,e,n){return $('.neighbor[data-site="'.concat(t,'"]')).find("div").removeClass(e).addClass(n)},t=function(){return o(n,"wait","fetch"),wiki.site(n).get("system/sitemap.json",function(t,e){return r.sitemapRequestInflight=!1,t?(o(n,"fetch","fail"),wiki.site(n).refresh(function(){})):(r.sitemap=e,o(n,"fetch","done"),$("body").trigger("new-neighbor-done",n))}),wiki.site(n).getIndex("system/site-index.json",function(t,e){if(t)return console.log("error loading index",n,t);try{return r.siteIndex=g.loadJSON(e,{fields:["title","content"]}),console.log(n,"index loaded")}catch(t){return console.log("error loading index - not a valid index",n)}})},e=Date.now(),a<e?(a=e+500,setTimeout(t,100)):(setTimeout(t,a-e),a+=500)},h.retryNeighbor=function(t){var e;return console.log("retrying neighbor"),h.sites[t]=e={},r(t,e)},h.registerNeighbor=function(t){var e;if(null==h.sites[t])return h.sites[t]=e={},r(t,e),$("body").trigger("new-neighbor",t)},h.updateSitemap=function(t){var e,n,r,o,i,a=location.host;if((n=h.sites[a])&&!n.sitemapRequestInflight)return r=t.getSlug(),e=t.getDate(),i=t.getTitle(),o=t.getSynopsis(),t=t.getLinks(),o={slug:r,date:e,title:i,synopsis:o,links:t},0<=(n=(t=n.sitemap).findIndex(function(t){return t.slug===r}))?t[n]=o:t.push(o),$("body").trigger("new-neighbor-done",a)},h.deleteFromSitemap=function(t){var e,n,r,o,i=location.host;if((n=h.sites[i])&&!n.sitemapRequestInflight&&(o=t.getSlug(),0<=(e=(r=n.sitemap).findIndex(function(t){return t.slug===o}))))return r.splice(e),$("body").trigger("delete-neighbor-done",i)},h.listNeighbors=function(){return o.keys(h.sites)},i=function(t,e){var n,r,o,i;switch(e.type){case"paragraph":case"markdown":t+=" "+e.text.replace(/\[{2}|\[(?:[\S]+)|\]{1,2}/g,"");break;case"html":t+=" "+e.text.replace(/<[^>]*>/g,"");break;default:if(null!=e.text)for(n=0,r=(i=e.text.split(/\r\n?|\n/)).length;n<r;n++)(o=i[n]).match(/^[A-Z]+[ ].*/)||(t+=" "+o.replace(/\[{2}|\[(?:[\S]+)|\]{1,2}/g,""))}return t},h.updateIndex=function(t,e){var n,r,o;if(console.log("updating ".concat(t.getSlug()," in index")),o=location.host,n=h.sites[o]){r=e.reduce(i,""),o=t.getSlug(),e=t.getTitle(),t=t.getRawPage().story.reduce(i,"");try{n.siteIndex.remove({id:o,title:e,content:r})}catch(t){(r=t).message.includes("not in the index")||console.log("removing ".concat(o," from index failed"),r)}return n.siteIndex.add({id:o,title:e,content:t})}},h.deleteFromIndex=function(e){var t,n,r=location.host;if(t=h.sites[r]){n=e.getSlug(),r=e.getTitle(),e=e.getRawPage().story.reduce(i,"");try{return t.siteIndex.remove({id:n,title:r,content:e})}catch(t){if(!(e=t).message.includes("not in the index"))return console.log("removing ".concat(n," from index failed"),e)}}},h.search=function(t){var e,o,n,r,i,a,u=[],c={},s=function(t){return null!=c[t]?c[t]++:c[t]=1},l=function(t,e){var n,r="indexing sitemap ( ".concat(t," )");return console.time(r),console.log("indexing sitemap:",t),n=new g({fields:["title","content"]}),o.sitemap.forEach(function(t){n.add({id:t.slug,title:t.title,content:t.synopsis})}),console.timeEnd(r),n},f=Date.now(),d=h.sites;for(n in d)p.call(d,n)&&(o=d[n]).sitemap&&null==o.siteIndex&&(o.siteIndex=l(n));for(n in r=location.host,i=h.sites)if(p.call(i,n)&&(o=i[n]).siteIndex){s("sites");try{null!=c.pages?c.pages+=o.sitemap.length:c.pages=o.sitemap.length}catch(t){console.info("+++ sitemap not valid for ",n),o.sitemap=[]}e=n===r?(a=20,2):(a=10,1),o.siteIndex.search(t,{boost:{title:a,content:e},prefix:!0,combineWith:"AND"}).forEach(function(e){return s("finds"),u.push({page:o.sitemap.find(function(t){return t.slug===e.id}),site:n,rank:e.score})})}return u.sort(function(t,e){return e.rank-t.rank}),c.msec=Date.now()-f,{finds:u,tally:c}},h.backLinks=function(n){var t,r,e,o=[],i=h.sites;for(r in i)p.call(i,r)&&(t=i[r]).sitemap&&t.sitemap.forEach(function(t,e){if(null!=t.links&&0<Object.keys(t.links).length&&Object.keys(t.links).includes(n))return o.push({slug:t.slug,title:t.title,site:r,itemId:t.links[n],date:t.date})});return e={},o.forEach(function(t){return n=t.slug,e[n]=e[n]||{},e[n].title=t.title,e[n].sites=e[n].sites||[],e[n].sites.push({site:t.site,date:t.date,itemId:t.itemId})}),e}},{minisearch:49,underscore:56}],19:[function(t,e,n){"use strict";var r=t("./link"),o=t("./wiki"),i=t("./neighborhood"),a=null,u=0,c=function(t){return t.hasOwnProperty("links")},s=function(t){return console.log("neighbor - flag"),'<span class="neighbor" data-site="'.concat(t,'">\n  <div class="wait">\n    <img src="').concat(o.site(t).flag(),'" title="').concat(t,'">\n  </div>\n</span>')};e.exports={inject:function(t){return a=t.sites},bind:function(){var n=$(".neighborhood");return $("body").on("new-neighbor",function(t,e){return n.append(s(e))}).on("new-neighbor-done",function(t,e){var n,r;try{r=a[e].sitemap.length}catch(t){r=0}n=$('.neighborhood .neighbor[data-site="'.concat(e,'"]')).find("img");try{a[e].sitemap.some(c)?n.attr("title","".concat(e,"\n ").concat(r," pages with 2-way links")):n.attr("title","".concat(e,"\n ").concat(r," pages"))}catch(t){console.info("+++ sitemap not valid for ",e),a[e].sitemap=[]}return u+=r,$(".searchbox .pages").text("".concat(u," pages"))}).delegate(".neighbor img","click",function(t){var e;return $(t.target).parent().hasClass("fail")?($(t.target).parent().removeClass("fail").addClass("wait"),e=$(t.target).attr("title"),o.site(e).refresh(function(){return console.log("about to retry neighbor"),i.retryNeighbor(e)})):r.doInternalLink("welcome-visitors",null,this.title.split("\n")[0])})}}},{"./link":17,"./neighborhood":18,"./wiki":38}],20:[function(t,e,n){"use strict";var u=t("./util").formatDate,c=t("./random"),s=t("./revision"),h=t("./synopsis"),p=t("underscore"),t=new(t("events").EventEmitter),g=function(t){return t.replace(/\s/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase()},v=function(t){return[{symbol:"❄",date:t-316224e5,period:"a Year"},{symbol:"⚘",date:t-80352e5,period:"a Season"},{symbol:"⚪",date:t-26784e5,period:"a Month"},{symbol:"☽",date:t-6048e5,period:"a Week"},{symbol:"☀",date:t-864e5,period:"a Day"},{symbol:"⌚",date:t-36e5,period:"an Hour"}]},m=function(t,l){var e,n,r,o,i,f,a,d=t||{};return d.title||(d.title="empty"),d.story||(d.story=[]),d.journal||(d.journal=[]),a=function(t,e){for(var n,r=0,o=t.length;r<o;r++)if((n=t[r]).id===e.id&&n.date===e.date)return!1;return!0},{getRawPage:function(){return d},getContext:function(){var t,e,n,r,o,i=["view"];for(f()&&i.push(l),e=function(t){if(null!=t&&!p.include(i,t))return i.push(t)},r=(o=d.journal.slice(n=0).reverse()).length;n<r;n++)e(null!=(t=o[n])?t.site:void 0);return i},isPlugin:i=function(){return null!=d.plugin},isRemote:f=function(){return!(null==l||"view"===l||"origin"===l||"local"===l||"recycler"===l)},isLocal:function(){return"local"===l},isRecycler:function(){return"recycler"===l},getRemoteSite:n=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return f()?l:t},getRemoteSiteDetails:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=[];return(t||f())&&e.push(n(t)),i()&&e.push("".concat(d.plugin," plugin")),e.join("\n")},getSlug:o=function(){return g(d.title)},getNeighbors:function(t){var e,n,r,o,i,a,u,c,s=[];for(f()?s.push(l):null!=t&&s.push(t),r=0,i=(u=d.story).length;r<i;r++)null!=(null!=(n=u[r])?n.site:void 0)&&s.push(n.site);for(o=0,a=(c=d.journal).length;o<a;o++)null!=(null!=(e=c[o])?e.site:void 0)&&s.push(e.site);return p.uniq(s)},getTitle:function(){return d.title},getLinks:function(){var t,e=function(t,e,n,r){var o,i,a;try{for(i=/\[\[([^\]]+)\]\]/g,0;null!==(a=i.exec(e.text));)t.has(g(a[1]))||t.set(g(a[1]),e.id);"reference"===e.type&&(t.has(e.slug)||t.set(e.slug,e.id))}catch(t){o=t,console.log("*** Error extracting links from ".concat(n," of ").concat(JSON.stringify(r)),o.message)}return t};try{t=d.story.reduce(e,new Map)}catch(t){e=t,console.log("+++ Extract links on ".concat(d.slug," fails"),e)}return 0<t.size?Object.fromEntries(t):{}},setTitle:function(t){return d.title=t},getRevision:r=function(){return d.journal.length-1},getDate:function(){var t=d.journal[r()];if(null!=t&&null!=t.date)return t.date},getTimestamp:function(){var t=d.journal[r()];return null!=t?null!=t.date?u(t.date):"Revision ".concat(r()):"Unrecorded Date"},getSynopsis:function(){return h(d)},addItem:e=function(t){return t=p.extend({},{id:c.itemId()},t),d.story.push(t)},getItem:function(t){for(var e,n=d.story,r=0,o=n.length;r<o;r++)if((e=n[r]).id===t)return e;return null},addParagraph:function(t){return e({type:"paragraph",text:t})},seqItems:function(r){return new Promise(function(e,t){var n=function(t){return t>=d.story.length?e():r(d.story[t]||{text:"null"},function(){return n(t+1)})};return n(0)})},seqActions:function(u){var c=0,s=v((new Date).getTime()),l=function(t){var e,n,r,o,i,a;if(!(t>=d.journal.length)){for(n=(e=d.journal[t]||{}).date||0,a=null,r=0,o=s.length;r<o;r++)(i=s[r]).date>c&&i.date<n&&(a=i);return c=n,u({action:e,separator:a},function(){return l(t+1)})}};return l(0)},become:function(t,e){if(d.story=(null!=t?t.getRawPage().story:void 0)||[],null!=e)return d.journal=null!=e?e.getRawPage().journal:void 0},siteLineup:function(){var t=o(),t="welcome-visitors"===t?"view/welcome-visitors":"view/welcome-visitors/view/".concat(t);return f()?wiki.site(l).getDirectURL(t):"/".concat(t)},merge:function(t){for(var o,e=function(){for(var t=d.journal,e=[],n=0,r=t.length;n<r;n++)o=t[n],e.push(o);return e}(),n=t.getRawPage().journal,r=0,i=n.length;r<i;r++)o=n[r],a(d.journal,o)&&e.push(o);return e.push({type:"fork",site:t.getRemoteSite(),date:(new Date).getTime()}),m(s.create(999,{title:d.title,journal:e}),l)},apply:function(t){if(s.apply(d,t),t.site)return l=null},getCreate:function(){var t=function(t){return"create"===t.type};return d.journal.reverse().find(t)}}};e.exports={newPage:m,asSlug:g,asTitle:function(t){return t.replace(/-/g," ")},pageEmitter:t}},{"./random":25,"./revision":29,"./synopsis":35,"./util":37,events:47,underscore:56}],21:[function(t,e,n){"use strict";var c,i,o,s,a,l,u=t("underscore"),f=t("./state"),d=t("./revision"),h=t("./addToJournal"),p=t("./page").newPage,g=(t("./random"),t("./lineup")),v=t("./neighborhood");e.exports=o={},c=function(t){return JSON.parse(JSON.stringify(t))},o.useLocalStorage=function(){return 0<$(".login").length},i=function(t){if(t=localStorage.getItem(t))return JSON.parse(t)},l=function(t){var r=t.pageInformation,o=t.whenGotten,i=t.whenNotGotten,a=t.localContext,t=r.slug,u=r.rev,c=r.site,e={get:function(n,r){return wiki.local.get(n,function(t,e){return console.log([t,e]),null!=t?wiki.origin.get(n,r):(c="local",r(null,e))})}};return c?a=[]:c=a.shift(),null===(c=c===window.location.host?"origin":c)&&(c="view"),function(){switch(c){case"local":return wiki.local;case"origin":return wiki.origin;case"recycler":return wiki.recycler;case"view":return e;default:return wiki.site(c)}}().get("".concat(t,".json"),function(t,e){var n;return t?404===t.xhr.status||0===t.xhr.status?0<a.length?l({pageInformation:r,whenGotten:o,whenNotGotten:i,localContext:a}):i():(n="The page handler has run into problems with this request.\n<pre class=error>".concat(JSON.stringify(r),"</pre>\nThe requested url.\n<pre class=error>").concat(url,"</pre>\nThe server reported status.\n<pre class=error>").concat(null!=(n=t.xhr)?n.status:void 0,"</pre>\nThe error message.\n<pre class=error>").concat(t.msg,"</pre>\nThese problems are rarely solved by reporting issues.\nThere could be additional information reported in the browser's console.log.\nMore information might be accessible by fetching the page outside of wiki.\n<a href=\"").concat(url,'" target="_blank">try-now</a>'),(t=p({title:"Trouble: Can't Get Page"},null)).addItem({type:"html",text:n}),o(t)):(console.log("got",c,e),u&&(e=d.create(u,e)),o(p(e,c)))})},o.get=function(t){var e,n=t.whenGotten,r=t.whenNotGotten,t=t.pageInformation;return!t.site&&(e=i(t.slug))?(t.rev&&(e=d.create(t.rev,e)),n(p(e,"local"))):(o.context.length||(o.context=["view"]),l({pageInformation:t,whenGotten:n,whenNotGotten:r,localContext:u.clone(o.context)}))},o.context=[],s=function(t,e,n){var r,o;return"create"===n.type?r={title:n.item.title,story:[],journal:[]}:(null==(r=(r=i(e.slug))||g.atKey(t.data("key")).getRawPage()).journal&&(r.journal=[]),null!=(o=n.fork)&&(r.journal=r.journal.concat({type:"fork",site:o,date:(new Date).getTime()}),delete n.fork)),d.apply(r,n),wiki.local.put(e.slug,r,function(){return h(t.find(".journal"),n),t.addClass("local")})},a=function(r,o,i){var a=c(i),u=g.atKey(r.data("key"));return"fork"===i.type&&(a.item=c(u.getRawPage())),wiki.origin.get("".concat(o.slug,".json"),function(t,e){var n=!t&&e.story||[];return wiki.origin.put(o.slug,a,function(t){return t?(i.error={type:t.type,msg:t.msg,response:t.xhr.responseText},s(r,o,i)):(null!=u&&u.apply&&u.apply(i),v.updateSitemap(u),v.updateIndex(u,n),h(r.find(".journal"),i),"fork"===i.type?wiki.local.delete(r.attr("id")):void 0)})})},o.put=function(e,t){var n=function(){var t;switch(t=e.data("site")){case"origin":case"local":case"view":case location.host:return null;default:return t}},r={slug:e.attr("id").split("_rev")[0],rev:e.attr("id").split("_rev")[1],site:n(),local:e.hasClass("local")},n=r.site;return console.log("pageHandler.put",t,r),o.useLocalStorage()&&(null!=r.site?console.log("remote => local"):r.local||(console.log("origin => local"),t.site=n=location.host)),t.date=(new Date).getTime(),"origin"===t.site&&delete t.site,e.removeClass("plugin"),n&&(e.find("h1").prop("title",location.host),e.find("h1 img").attr("src","/favicon.png"),e.find("h1 a").attr("href","/view/welcome-visitors/view/".concat(r.slug)).attr("target",location.host),e.data("site",null),e.removeClass("remote"),f.setUrl(),"fork"!==t.type&&(t.fork=n,h(e.find(".journal"),{type:"fork",site:n,date:t.date}))),(o.useLocalStorage()||"local"===r.site?s:a)(e,r,t)},o.delete=function(e,t,n){return console.log("delete server-side"),console.log("pageObject:",e),e.isRecycler()?wiki.recycler.delete("".concat(e.getSlug(),".json"),function(t){return setTimeout(function(){return n(t)},300)}):wiki.origin.delete("".concat(e.getSlug(),".json"),function(t){return setTimeout(function(){return null==t&&v.deleteFromSitemap(e),null==t&&v.deleteFromIndex(e),n(t)},300)})}},{"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./random":25,"./revision":29,"./state":34,underscore:56}],22:[function(t,e,n){"use strict";var r=t("./editor"),u=t("./resolve"),o=t("./itemz"),i=function(t){return t.match(/<(i|b|p|a|h\d|hr|br|li|img|div|span|table|blockquote)\b.*?>/i)?"html":"markdown"};e.exports={emit:function(t,e){for(var n,r=e.text.split(/\n\n+/),o=[],i=0,a=r.length;i<a;i++)(n=r[i]).match(/\S/)?o.push(t.append("<p>".concat(u.resolveLinks(n),"</p>"))):o.push(void 0);return o},bind:function(e,n){return e.dblclick(function(t){return t.shiftKey?(n.type=i(n.text),o.replaceItem(e,"paragraph",n)):r.textEditor(e,n,{append:!0})})}}},{"./editor":8,"./itemz":13,"./resolve":28}],23:[function(t,e,n){"use strict";var r,o,u,i,a,c,s,l,f=[].indexOf;e.exports=s={},u=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},a=function(t,e){return console.log("loading url:",t),e=$.extend(e||{},{dataType:"script",cache:!0,url:t}),$.ajax(e)},l=[],c={},i=s.getScript=function(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return 0<=f.call(l,r)?o():a(r).done(function(){return l.push(r),o()}).fail(function(t,e,n){return console.log("getScript: Failed to load:",r,n),o()})},s.renderFrom=function(t){var o,i,e=$(".item").slice(t);return console.log("notifIndex",t,"about to render",e.toArray()),i=Promise.resolve(),i=(i=(o=function(t){var n,r,e;return 0===t.length?i:(e=t.shift(),(n=$(e)).hasClass("textEditing")||(r=n.data("item"),i=i.then(function(){return new Promise(function(t,e){return n.off(),s.emit(n.empty(),r,function(){return t()})})})),o(t))})(e.toArray())).then(function(){var o;return i=Promise.resolve(),(o=function(t){var n,r,e;return 0===t.length?i:(e=t.shift(),n=$(e),r=n.data("item"),i=i.then(function(){return new Promise(function(e,t){return s.getPlugin(r.type,function(t){return t.bind(n,r),e()})})}),o(t))})(e.toArray())})},o=function(n){return function(t,e){return t.addClass("emit"),n(t,e)}},r=function(u,c){return function(o,e,t){var n,i,r,a;return o[0].consuming=[],r=$(".item").index(o),n=window.plugins[u].consumes,a=Promise.resolve(),n&&(i=[],n.forEach(function(t){var e=$(".item:lt(".concat(r,")")).filter(t);return console.log(u,"consumes",t),console.log(e,"produce",t),e&&0!==e.length||console.log("warn: no items in lineup that produces",t),console.log("there are ".concat(e.length," instances of ").concat(t)),e.each(function(t,e){var n=$(e).parents(".page").data("key"),r=$(e).attr("data-id");return o[0].consuming.push("".concat(n,"/").concat(r)),i.push(e.promise)})}),a=Promise.all(i)),a.then(function(){var t;return o.removeClass("emit"),(t=c(o,e))&&"function"!=typeof t.then||(t=Promise.resolve(t)),o[0].promise=t}).catch(function(t){return console.log("plugin emit: unexpected error",t)})}},s.wrap=function(t,e){return e.emit=o(e.emit),e.bind=r(t,e.bind),e},s.get=s.getPlugin=function(n,e){return c[n]?c[n].then(e):(c[n]=new Promise(function(e,t){return window.plugins[n]?e(window.plugins[n]):i("/plugins/".concat(n,"/").concat(n,".js"),function(){var t=window.plugins[n];return t?(s.wrap(n,t),e(t)):i("/plugins/".concat(n,".js"),function(){return(t=window.plugins[n])&&s.wrap(n,t),e(t)})})}),c[n].then(function(t){return delete c[n],e(t)}),c[n])},s.do=s.doPlugin=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};return t.data("item",e),s.renderFrom($(".item").index(t)).then(function(){return n()})},s.emit=function(r,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=function(t,e){return r.append('<div class="error">\n  '.concat(u(o.text||""),"\n  <button>help</button><br>\n</div>")),null!=o.text&&r.find(".error").dblclick(function(t){return wiki.textEditor(r,o)}),r.find("button").on("click",function(){return wiki.dialog(t.toString(),'<p> This "'.concat(o.type,'" plugin won\'t show.</p>\n<li> Is it available on this server?\n<li> Is its markup correct?\n<li> Can it find necessary data?\n<li> Has network access been interrupted?\n<li> Has its code been tested?\n<p> Developers may open debugging tools and retry the plugin.</p>\n<button class="retry">retry</button>\n<p> Learn more\n  <a class="external" target="_blank" rel="nofollow"\n  href="http://plugins.fed.wiki.org/about-plugins.html"\n  title="http://plugins.fed.wiki.org/about-plugins.html">\n    About Plugins\n    <img src="/images/external-link-ltr-icon.png">\n  </a>\n</p>')),$(".retry").on("click",function(){return 2<e.emit.length?e.emit(r,o,function(){return i()}):(e.emit(r,o),i())})})};return r.data("pageElement",r.parents(".page")),r.data("item",o),s.get(o.type,function(e){var n;try{if(null==e)throw TypeError("Can't find plugin for '".concat(o.type,"'"));return 2<e.emit.length?e.emit(r,o,function(){return e.bind(r,o),i()}):(e.emit(r,o),i())}catch(t){return n=t,console.log("plugin error",n),a(n,e),i()}})},s.registerPlugin=function(t,e){return window.plugins[t]=e($)}},{}],24:[function(t,e,n){"use strict";var r=t("./plugin");window.plugins={reference:r.wrap("reference",t("./reference")),factory:r.wrap("factory",t("./factory")),paragraph:r.wrap("paragraph",t("./paragraph")),image:r.wrap("image",t("./image")),future:r.wrap("future",t("./future")),importer:r.wrap("importer",t("./importer"))}},{"./factory":9,"./future":10,"./image":11,"./importer":12,"./paragraph":22,"./plugin":23,"./reference":26}],25:[function(t,e,n){"use strict";var o=function(){return(256*(1+Math.random())|0).toString(16).substring(1)},r=function(r){return function(){for(var t=[],e=1,n=r;1<=n?e<=n:n<=e;1<=n?e++:e--)t.push(o());return t}().join("")};e.exports={randomByte:o,randomBytes:r,itemId:function(){return r(8)}}},{}],26:[function(t,e,n){"use strict";var r=t("./editor"),o=t("./resolve"),i=t("./page");e.exports={emit:function(t,e){var n,r=e.slug;return r=(r=null!=e.title?r||i.asSlug(e.title):r)||"welcome-visitors",n=e.site,o.resolveFrom(n,function(){return t.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(o.resolveLinks("[[".concat(e.title||r,"]]")),"\n  —\n  ").concat(o.resolveLinks(e.text),"\n</p>"))})},bind:function(t,e){return t.dblclick(function(){return r.textEditor(t,e)})}}},{"./editor":8,"./page":20,"./resolve":28}],27:[function(t,e,n){"use strict";function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d=t("underscore"),h=t("./pageHandler"),p=t("./plugin"),o=t("./state"),y=t("./neighborhood"),g=t("./addToJournal"),i=t("./actionSymbols"),v=t("./lineup"),m=t("./resolve"),a=t("./random"),t=t("./page"),b=t.newPage,w=t.asSlug,u=t.pageEmitter,x=function(t){if(0<$(t).length)return $(t).data("item")||$(t).data("staticItem")},k=function(t,e,n){n=$.extend({},n);return e.data("item",n),null!=(t=v.atKey(t.data("key"))).getItem(n.id)?(n.alias||(n.alias=n.id),n.id=a.itemId(),e.attr("data-id",n.id),e.data("id",n.id),e.data("item").id=n.id):null!=n.alias&&null==t.getItem(n.alias)&&(n.id=n.alias,delete n.alias,e.attr("data-id",n.id)),n},_=function(t,e){return t&&e&&t.get(0)===e.get(0)},S=function(t){return t.children().map(function(t,e){return $(e).attr("data-id")}).get()},c=function(t,e,n,r){var o,i=e.item,a=x(i),u=i.data("pageElement"),c=u.hasClass("ghost")||u.hasClass("remote"),s=i.parents(".page:first"),l=s.hasClass("ghost"),f=_(u,s),e=!f&&u.attr("id")===s.attr("id");if(!l&&!e)return f?(f=S(i.parents(".story:first")),void(d.isEqual(f,r)||($(".shadow-copy").remove(),i.empty(),o=$(".item").index(i),p.renderFrom(o=n<o?n:o),h.put(s,{id:a.id,type:"move",order:f})))):(c||t.shiftKey?$(".shadow-copy").removeClass("shadow-copy").data(i.data()).attr({"data-id":i.attr("data-id")}):h.put(u,{id:a.id,type:"remove"}),i.data("pageElement",s),c=i.prev(".item"),u=x(c),a=k(s,i,a),h.put(s,{id:a.id,type:"add",item:a,after:null!=u?u.id:void 0}),$(".shadow-copy").remove(),i.empty(),c.after(i),o=$(".item").index(i),p.renderFrom(o=n<o?n:o));$(t.target).sortable("cancel")},s=function(t,e){var n=e.item.data("pageElement"),r=n.hasClass("ghost")||n.hasClass("remote"),o=e.placeholder.parents(".page:first"),i=o.hasClass("ghost"),e=_(n,o),o=!e&&n.attr("id")===o.attr("id"),e=r||t.shiftKey&&!e;return i||o?($("body").css("cursor","no-drop"),$(".shadow-copy").hide()):e?($("body").css("cursor","copy"),$(".shadow-copy").show()):($("body").css("cursor","move"),$(".shadow-copy").hide())},l=function(t){var n=$("body").css("cursor"),e={connectWith:".page .story",placeholder:"item-placeholder",forcePlaceholderSize:!0,delay:150},r=t.find(".story"),o=null,i=null,a=null,u=function(t){if(27===t.which)return a=!0,r.sortable("cancel")};return r.sortable(e).on("sortstart",function(t,e){var n=e.item;return o=S(r),i=$(".item").index(n),a=!1,$("body").on("keydown",u),n.clone().insertAfter(e.placeholder).hide().addClass("shadow-copy").css({width:"",height:"",position:"",zIndex:""}).removeAttr("data-id")}).on("sort",s).on("sortstop",function(t,e){return $("body").css("cursor",n).off("keydown",u),a||c(t,e,i,o),$(".shadow-copy").remove()})},I=function(t){t=$(t).parents(".page:first");return v.atKey(t.data("key"))},j=function(t,e){e=I(e.draggable),t=I(t.target);return u.emit("show",t.merge(e))},E=function(t){t=t.find(".journal");return t.draggable({revert:!0,appendTo:".main",scroll:!1,helper:"clone"}),t.droppable({hoverClass:"ui-state-hover",drop:j,accept:".journal"})},A=function(e){return e.find(".add-factory").on("click",function(t){if(!e.hasClass("ghost"))return t.preventDefault(),C(e)})},C=function(t){var e={type:"factory",id:a.itemId()},n=$("<div />",{class:"item factory"}).data("item",e).attr("data-id",e.id);return n.data("pageElement",t),t.find(".story").append(n),p.do(n,e),n=n.prev(".item"),n=x(n),h.put(t,{item:e,id:e.id,type:"add",after:null!=n?n.id:void 0})},O=function(t){var o;t.preventDefault(),v.debugSelfCheck(function(){for(var t=$(".page"),e=[],n=0,r=t.length;n<r;n++)o=t[n],e.push($(o).data("key"));return e}());var e,n=$(t.target).parents(".page:first"),t=f(e=v.crumbs(n.data("key"),location.host),1)[0];return""===(n=f(wiki.site(t).getDirectURL("").split("/"),1)[0])&&(n=window.location.protocol),window.open("".concat(n,"//").concat(e.join("/")),t).focus()},T=function(t,e,n){var r=n.isRecycler()?"recycler":n.getRemoteSite(location.host),o=n.getRemoteSiteDetails(location.host);return t.append('<h1 title="'.concat(o,'">\n  <span>\n    <a href="').concat(n.siteLineup(),'" target="').concat(r,'">\n      <img src="').concat(wiki.site(r).flag(),'" height="32px" class="favicon"></a>\n    ').concat(m.escape(n.getTitle()),"\n  </span>\n</h1>")),t.find("a").on("click",O)},F=function(t,e,n){if(e.attr("id").match(/_rev/))return e.addClass("ghost"),e.data("rev",n.getRevision()),t.append($('<h2 class="revision">\n  <span>\n    '.concat(n.getTimestamp(),"\n  </span>\n</h2>")))},L=function(t){return t.append('<div class="control-buttons">\n  <a href="#" class="button fork-page" title="fork this page">'.concat(i.fork,'</a>\n  <a href="#" class="button add-factory" title="add paragraph">').concat(i.add,"</a>\n</div>"))},R=function(t,e){var n,r,o,i,a,u,c,s,l,f,d,e=e.getSlug(),h=y.backLinks(e);if(0<Object.keys(h).length){for(c in s=[],h){for((n=h[c]).sites.sort(function(t,e){return(t.date||0)<(e.date||0)}),r=[],o=i=0,a=(l=n.sites).length;i<a;o=++i)d=l[o],o<10?(f=(null!=(f=n.sites[o-1])?f.date:void 0)===d.date?"":" ",r.unshift(f),r.unshift('<img class="remote"\n    src="'.concat(wiki.site(d.site).flag(),'"\n    data-slug="').concat(c,'"\n    data-site="').concat(d.site,'"\n    data-id="').concat(d.itemId,'"\n    title="').concat(d.site,"\n").concat(wiki.util.formatElapsedTime(d.date),'">'))):10===o&&r.unshift(" ⋯ ");u=m.resolveLinks("[[".concat(n.title,"]]")),s.push('<div style="clear: both;">\n  <div style="float: left;">'.concat(u,'</div>\n  <div style="text-align: right;"> ').concat(r.join("")," </div>\n</div>"))}if(s)return t.append("<details>\n  <summary>".concat(s.length," pages link here:</summary>\n  ").concat(s.join("\n"),"\n</details>"))}},D=function(t,e){var n=e.getRemoteSite(location.host),e=e.getSlug();return t.append('<a class="show-page-license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> .\n<a class="show-page-source" href="'.concat(wiki.site(n).getDirectURL(e),'.json" title="source">JSON</a> .\n<a href= "').concat(wiki.site(n).getDirectURL(e),'.html" date-slug="').concat(e,'" target="').concat(n,'">').concat(n,' </a> .\n<a href= "#" class=search>search</a>'))},P=function(t){for(var e,n=t||[],r=n.length-1;0<=r;r+=-1)if((e=n[r]).date&&"fork"!==e.type)return e.date},N=function(t){var o,e,n,i,r,a,u,c,s,l,f,d,h,p,g,v,m=t.data("data");if(m&&("view"!==(h=t.data("site")||window.location.host)&&"origin"!==h||(h=window.location.host),p=w(m.title),v=P(m.journal))){for(d in e={newer:[],same:[],older:[]},l=y.sites)if(r=l[d],d!==h&&null!=r.sitemap)for(u=0,s=(f=r.sitemap).length;u<s;u++)(a=f[u]).slug===p&&(o=a.date>v?e.newer:a.date<v?e.older:e.same).push({remoteSite:d,item:a});for(c in g=[],e)(o=e[c]).length&&(o.sort(function(t,e){return t.item.date<e.item.date}),n=function(){var t,e,n=[];for(i=t=0,e=o.length;t<e;i=++t){var r=o[i];if(d=r.remoteSite,a=r.item,8<=i)break;n.push('<img class="remote"\nsrc="'.concat(wiki.site(d).flag(),'"\ndata-slug="').concat(p,'"\ndata-site="').concat(d,'"\ntitle="').concat(d,'">'))}return n}(),g.push("".concat(n.join("&nbsp;")," ").concat(c)));if(g)return t.find(".twins").html("<p><span>".concat(g.join(", "),"</span></p>"))}},M=function(t,e){var n,o;e.data("data",t.getRawPage()),t.isRemote()&&e.data("site",t.getRemoteSite()),console.log(".page keys ",function(){for(var t=$(".page"),e=[],n=0,r=t.length;n<r;n++)o=t[n],e.push($(o).data("key"));return e}()),console.log("lineup keys",v.debugKeys()),m.resolutionContext=t.getContext(),e.empty(),n=$("<div class='paper' />"),e.append(n);var r=f(["handle-parent","twins","header","story","backlinks","journal","footer"].map(function(t){if("journal"!==t||$(".editEnable").is(":visible"))return $("<div />").addClass(t).appendTo(n)}),7),i=r[0],a=(r[1],r[2]),u=r[3],c=r[4],s=r[5],l=r[6],r=$("<div />").addClass("page-handle").appendTo(i);return T(a,0,t),F(a,e,t),a=(a=t.seqItems(function(t,e){var n=$('<div class="item '.concat(t.type,'" data-id="').concat(t.id,'">'));return u.append(n),n.data("item",t),e()})).then(function(){var t=$(".page").index(e[0]),t=$(".item").index($($(".page")[t]).find(".item"));return p.renderFrom(t)}).then(function(){return e}),$(".editEnable").is(":visible")&&t.seqActions(function(t,e){return t.separator&&g(s,t.separator),g(s,t.action),e()}),N(e),R(c,t),$(".editEnable").is(":visible")&&L(s),D(l,t),r.css({height:"".concat(u.position().top-i.position().top-5,"px")}),a},B=function(t,e){if(!e.isRemote())return $("img.favicon",t).on("error",function(){return p.get("favicon",function(t){return t.create()})})},z=function(t,e){var n;return t.isLocal()&&e.addClass("local"),t.isRecycler()&&e.addClass("recycler"),t.isRemote()&&e.addClass("remote"),t.isPlugin()&&e.addClass("plugin"),n=M(t,e),B(e,t),o.setUrl(),$(".editEnable").is(":visible")&&(l(e),E(e),A(e)),n},U=function(t,e){return e.data("key",v.addPage(t)),z(t,e)},q=function(t,e){var n,r,o,i,a,u,c,s,l=w(t),f=b();for(s in f.setTitle(t),r=[],u=y.sites)null!=(o=u[s]).sitemap&&null!=(c=d.find(o.sitemap,function(t){return t.slug===l}))&&r.push({type:"reference",site:s,slug:l,title:c.title||l,text:c.synopsis||""});if(0<r.length)for(f.addItem({type:"future",text:"We could not find this page in the expected context.",title:t,create:e}),f.addItem({type:"paragraph",text:"We did find the page in your current neighborhood."}),i=0,a=r.length;i<a;i++)n=r[i],f.addItem(n);else f.addItem({type:"future",text:"We could not find this page.",title:t,create:e});return f};e.exports={cycle:function(a){var u=new Promise(function(i,t){var e=f(a.attr("id").split("_rev"),2),n=e[0],e=e[1],r=a.find(".header h1").text().trim(),e={slug:n,rev:e,site:a.data("site")};return h.get({whenGotten:function(t){var e,n,r,o;for(u=U(t,a),e=0,n=(r=t.getNeighbors(location.host)).length;e<n;e++)o=r[e],y.registerNeighbor(o);return i(u)},whenNotGotten:function(){var t=$('a.internal[href="/'.concat(n,'.html"]:last'));return r=r||t.text()||n,t=t.parents(".page").data("key"),null!=(t=v.atKey(t))&&t.getCreate(),t=q(r),(u=U(t,a)).then(function(t){return t.addClass("ghost")}),i(u)},pageInformation:e})});return u},emitTwins:N,buildPage:U,rebuildPage:z,newFuturePage:q}},{"./actionSymbols":2,"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./random":25,"./resolve":28,"./state":34,underscore:56}],28:[function(t,e,n){"use strict";var a,u,c=t("./page").asSlug;e.exports=u={},u.resolutionContext=[],u.escape=a=function(t){return(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},u.resolveFrom=function(t,e){u.resolutionContext.push(t);try{return e()}finally{u.resolutionContext.pop()}},u.resolveLinks=function(t){var n=[],o=function(t){var e=n.length;return n.push(t),"〖".concat(e,"〗")},e=function(t,e){return n[+e]},r=function(t,e){var n=c(e);return n.length?o('<a class="internal" href="/'.concat(n,'.html" data-page-name="').concat(n,'" title="').concat(u.resolutionContext.join(" => "),'">').concat(a(e),"</a>")):t},i=function(t,e,n,r){return o('<a class="external" target="_blank" href="'.concat(e,'" title="').concat(e,'" rel="nofollow">').concat(a(r),' <img src="/images/external-link-ltr-icon.png"></a>'))};return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:a)(t=(t||"").replace(/〖(\d+)〗/g,"〖 $1 〗").replace(/\[\[([^\]]+)\]\]/gi,r).replace(/\[((http|https|ftp):.*?) (.*?)\]/gi,i)).replace(/〖(\d+)〗/g,e)}},{"./page":20}],29:[function(t,e,n){"use strict";var u=function(i,e){var t,n,r=function(){for(var t,e=i.story||[],n=[],r=0,o=e.length;r<o;r++)t=e[r],n.push(null!=t?t.id:void 0);return n},o=function(t,e){t=r().indexOf(t)+1;return i.story.splice(t,0,e)},a=function(){var t;if(-1!==(t=r().indexOf(e.id)))return i.story.splice(t,1)};switch(i.story||(i.story=[]),e.type){case"create":null!=e.item&&(null!=e.item.title&&(i.title=e.item.title),null!=e.item.story&&(i.story=e.item.story.slice()));break;case"add":o(e.after,e.item);break;case"edit":-1!==(n=r().indexOf(e.id))?i.story.splice(n,1,e.item):i.story.push(e.item);break;case"move":n=e.order.indexOf(e.id),t=e.order[n-1],n=i.story[r().indexOf(e.id)],a(),o(t,n);break;case"remove":a()}return i.journal||(i.journal=[]),i.journal.push(e)};e.exports={create:function(t,e){for(var n,r=e.journal.slice(0,+(t=+t)+1||9e9),o={title:e.title,story:[]},i=0,a=r.length;i<a;i++)n=r[i],u(o,n||{});return o},apply:u}},{}],30:[function(t,e,n){"use strict";var g=t("./pageHandler"),v=t("./random"),c=t("./link"),s=(t("./active"),t("./page").newPage),o=t("./resolve"),i=t("./page"),m=function(t,e){var n,r=e.slug;return r=(r=null!=e.title?r||i.asSlug(e.title):r)||"welcome-visitors",n=e.site,o.resolveFrom(n,function(){return t.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(o.resolveLinks("[[".concat(e.title||r,"]]")),"\n  —\n  ").concat(o.resolveLinks(e.text),"\n</p>"))})},y=function(t,e){return t.preventDefault(),t.shiftKey||(i=$(t.target).parents(".page")),c.doInternalLink(e,i,$(t.target).data("site")),!1};e.exports=function(t){var p=t.neighborhood;return{incrementalSearch:function(t){var e,n,r,o,i,a,u,c,s,l,f,d,h;if(!(t.length<2)){for(0===$(".incremental-search").length&&(u=$(".searchbox").position(),$("<div/>").css("left","".concat(u.left,"px")).css("bottom","".concat(u.top+$(".searchbox").height(),"px")).addClass("incremental-search").delegate(".internal","click",function(t){var e;return"SPAN"===t.target.nodeName&&(t.target=$(t.target).parent()[0]),e=$(t.target).data("pageName"),e="".concat(e),g.context=$(t.target).attr("title").split(" => "),y(t,e)}).delegate("img.remote","click",function(t){var e;return $(t.target).attr("src").startsWith("data:image/png")?(t.preventDefault(),e=$(t.target).data("site"),wiki.site(e).refresh(function(){})):(e=$(t.target).data("slug"),g.context=[$(t.target).data("site")],y(t,e))}).appendTo($(".searchbox"))),d=p.search(t),h=t.split(" ").map(function(t){return t.toLowerCase()}).filter(String),f=new RegExp("\\b("+t.split(" ").map(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).filter(String).join("|")+")","i"),o=function(t){return t.split(f).map(function(t){return h.includes(t.toLowerCase())?"{{".concat(t,"}}"):t}).join("")},n=$(".incremental-search").empty(),d.finds&&0!==d.finds.length||$("<div/>").text("No results found").addClass("no-results").appendTo(n),l=[],i=r=0,a=(c=d.finds).length;i<a;i++)s=c[i],101===(r+=1)&&$("<div/>").text("".concat(d.finds.length-100," results omitted")).addClass("omitted-results").appendTo(n),100<r||(e=$("<div/>").appendTo(n),s={id:v.itemId(),type:"reference",site:s.site,slug:s.page.slug,title:o(s.page.title),text:o(s.page.synopsis)},m(e,s),l.push(e.html(e.html().split(new RegExp("({{.*?}})","i")).map(function(t){return 0===t.indexOf("{{")?"<span class='search-term'>".concat(t.substring(2,t.length-2),"</span>"):t}).join(""))));return l}$(".incremental-search").remove()},performSearch:function(t){var e,n,r,o,i,a,u=p.search(t);if(u.finds&&1===u.finds.length)return $(".incremental-search").find(".internal").click(),void $(".incremental-search").remove();for($(".incremental-search").remove(),a=u.tally,(i=s()).setTitle("Search for '".concat(t,"'")),i.addParagraph("String '".concat(t,"' found on ").concat(a.finds||"none"," of ").concat(a.pages||"no"," pages from ").concat(a.sites||"no"," sites.\nText matched on ").concat(a.title||"no"," titles, ").concat(a.text||"no"," paragraphs, and ").concat(a.slug||"no"," slugs.\nElapsed time ").concat(a.msec," milliseconds.")),e=0,n=(r=u.finds).length;e<n;e++)o=r[e],i.addItem({type:"reference",site:o.site,slug:o.page.slug,title:o.page.title,text:o.page.synopsis||""});return c.showResult(i)}}}},{"./active":3,"./link":17,"./page":20,"./pageHandler":21,"./random":25,"./resolve":28}],31:[function(t,e,n){"use strict";var r=t("./search"),o=null;e.exports={inject:function(t){return o=r({neighborhood:t})},bind:function(){return $("input.search").attr("autocomplete","off"),$("input.search").on("keydown",function(t){if(27===t.keyCode)return $(".incremental-search").remove()}),$("input.search").on("keypress",function(t){if(13===t.keyCode)return t=$(this).val(),o.performSearch(t),$(this).val("")}),$("input.search").on("focus",function(t){var e=$(this).val();return o.incrementalSearch(e)}),$("input.search").on("input",function(t){var e=$(this).val();return o.incrementalSearch(e)})}}},{"./search":30}],32:[function(t,e,n){"use strict";var r;e.exports={},r=t("./plugin"),e.exports=function(t){return r.getScript("/security/security.js",function(){return window.plugins.security.setup(t)})}},{"./plugin":23}],33:[function(t,e,n){"use strict";var u,c,i,s,r,l,f,o,d,a=t("async/queue"),t=t("localforage");e.exports=r={},l={},u={},f={},console.log("siteAdapter: loading data"),(s=t.createInstance({name:"routes"})).iterate(function(t,e,n){l[e]=t}).then(function(){return console.log("siteAdapter: data loaded")}).catch(function(t){return console.log("siteAdapter: error loading data ",t)}),(d=t.createInstance({name:"withCredentials"})).iterate(function(t,e,n){u[e]=t}).then(function(){return console.log("siteAdapter: withCredentials data loaded")}).catch(function(t){return console.log("siteAdapter: error loading withCredentials data ",t)}),o=function(n,t,e){var r=new Promise(function(t,e){var n;return n=setTimeout(function(){return clearTimeout(n),e()},3e3)}),o=new Promise(function(t,e){return $.ajax({type:"GET",url:n,success:function(){return t()},error:function(){return e()}})});return Promise.race([r,o]).then(function(){return t()}).catch(function(){return e()})},i=a(function(t,e){var n,r=t.site;return null!=l[r]&&e(l[r]),n="//".concat(r,"/favicon.png"),o(n,function(){return l[r]="//".concat(r),e("//".concat(r))},function(){switch(location.protocol){case"http:":return n="https://".concat(r,"/favicon.png"),o(n,function(){return l[r]="https://".concat(r),e("https://".concat(r))},function(){return l[r]="",e("")});case"https:":return n="/proxy/".concat(r,"/favicon.png"),o(n,function(){return l[r]="/proxy/".concat(r),e("/proxy/".concat(r))},function(){return l[r]="",e("")});default:return l[r]="",e("")}})},8),c=function(n,r){return s.getItem(n).then(function(t){return console.log("findAdapter: ",n,t),null==t?i.push({site:n},function(e){return l[n]=e,s.setItem(n,e).then(function(t){return r(e)}).catch(function(t){return console.log("findAdapter setItem error: ",n,t),r(e)})}):(l[n]=t,r(t))}).catch(function(t){return console.log("findAdapter error: ",n,t),l[n]="",r("")})},r.local={flag:function(){return"/favicon.png"},getURL:function(t){return"/".concat(t)},getDirectURL:function(t){return"/".concat(t)},get:function(t,n){var e,r=function(t,e){if(n)return n(t,e)};if(console.log("wiki.local.get ".concat(t)),e=localStorage.getItem(t.replace(/\.json$/,""))){if(r(null,e=JSON.parse(e)),!n)return Promise.resolve(e)}else if(r(t={msg:"no page named '".concat(t,"' in browser local storage")},null),console.log("tried to local fetch a page that isn't local"),!n)return Promise.reject(t)},put:function(t,e,n){return console.log("wiki.local.put ".concat(t)),localStorage.setItem(t,JSON.stringify(e)),n()},delete:function(t){return console.log("wiki.local.delete ".concat(t)),localStorage.removeItem(t)}},r.origin={flag:function(){return"/favicon.png"},getURL:function(t){return"/".concat(t)},getDirectURL:function(t){return"/".concat(t)},get:function(t,n){var r=function(t,e){if(n)return n(t,e)};return console.log("wiki.origin.get ".concat(t)),$.ajax({type:"GET",dataType:"json",url:"/".concat(t),success:function(t){return r(null,t)},error:function(t,e,n){return r({msg:n,xhr:t},null)}})},getIndex:function(t,n){var r=function(t,e){if(n)return n(t,e)};return console.log("wiki.origin.get ".concat(t)),$.ajax({type:"GET",dataType:"text",url:"/".concat(t),success:function(t){return r(null,t)},error:function(t,e,n){return r({msg:n,xhr:t},null)}})},put:function(t,e,r){return console.log("wiki.orgin.put ".concat(t)),$.ajax({type:"PUT",url:"/page/".concat(t,"/action"),data:{action:JSON.stringify(e)},success:function(){return r(null)},error:function(t,e,n){return r({xhr:t,type:e,msg:n})}})},delete:function(t,r){return console.log("wiki.origin.delete ".concat(t)),$.ajax({type:"DELETE",url:"/".concat(t),success:function(){return r(null)},error:function(t,e,n){return r({xhr:t,type:e,msg:n})}})}},r.recycler={flag:function(){return"/recycler/favicon.png"},getURL:function(t){return"/recycler/".concat(t)},getDirectURL:function(t){return"/recycler/".concat(t)},get:function(t,n){var r=function(t,e){if(n)return n(t,e)};return console.log("wiki.recycler.get ".concat(t)),$.ajax({type:"GET",dataType:"json",url:"/recycler/".concat(t),success:function(t){return r(null,t)},error:function(t,e,n){return r({msg:n,xhr:t},null)}})},delete:function(t,r){return console.log("wiki.recycler.delete ".concat(t)),$.ajax({type:"DELETE",url:"/recycler/".concat(t),success:function(){return r(null)},error:function(t,e,n){return r({xhr:t,type:e,msg:n})}})}},r.site=function(a){var e;return a&&a!==window.location.host?"recycler"===a?r.recycler:(e=function(t){var e,n,r,o,i,a,u;return console.log("creating temp flag for ".concat(t)),(r=document.createElement("canvas")).width=32,r.height=32,n=r.getContext("2d"),a=o=32*Math.random(),i=32-(u=32*Math.random()),t="#"+(e=(255*Math.random()<<0).toString(16))+e+e,e="#"+(e=(255*Math.random()<<0).toString(16))+e+e,(u=n.createRadialGradient(o,a,32,i,u,0)).addColorStop(0,t),u.addColorStop(1,e),n.fillStyle=u,n.fillRect(0,0,32,32),r.toDataURL()},{flag:function(){var t;return null!=l[a]?""===l[a]?null!=f[a]?f[a]:f[a]=e(a):l[a]+"/favicon.png":null!=f[a]?f[a]:(c(a,function(t){var e;return""===t?console.log("Prefix for ".concat(a," is undetermined...")):(console.log("Prefix for ".concat(a," is ").concat(t)),e=f[a],t=l[a]+"/favicon.png",$('img[src="'+e+'"]').attr("src",t),$('a[target="'+a+'"]').attr("style","background-image: url("+t+")"),f[a]=null)}),t=e(a),f[a]=t)},getURL:function(t){return null!=l[a]?""===l[a]?(console.log("".concat(a," is unreachable, can't link to ").concat(t)),""):"".concat(l[a],"/").concat(t):(c(a,function(e){return""===e?console.log("".concat(a," is unreachable")):(console.log("Prefix for ".concat(a," is ").concat(e,", about to fixup links")),$('a[target="'+a+'"]').each(function(){var t=/proxy/.test(e)?(t=e.substring(7),"http://".concat(t)):e;return $(this).attr("href","".concat(t,"/").concat($(this).data("slug"),".html"))}))}),"")},getDirectURL:function(t){var e,n;return null!=l[a]?""===l[a]?(console.log("".concat(a," is unreachable, can't link to ").concat(t)),""):(e=/proxy/.test(l[a])?(n=l[a].substring(7),"http://".concat(n)):l[a],"".concat(e,"/").concat(t)):(c(a,function(t){return""===t?console.log("".concat(a," is unreachable")):(console.log("Prefix for ".concat(a," is ").concat(t,", about to fixup links")),$('a[target="'+a+'"]').each(function(){return e=/proxy/.test(t)?(n=t.substring(7),"http://".concat(n)):t,$(this).attr("href","".concat(e,"/").concat($(this).data("slug"),".html"))}))}),"")},get:function(e,o){var n,r=function(t,e){if(o)return o(t,e)},i=function(e,r){var n="".concat(l[a],"/").concat(e),t=u[a]||!1;return $.ajax({type:"GET",dataType:"json",url:n,xhrFields:{withCredentials:t},success:function(t){return"Login Required"!==t.title||n.includes("login-required")||!0===u[a]?(r(null,t),o?void 0:Promise.resolve(t)):(u[a]=!0,i(e,function(t,e){return t?u[a]=!1:d.setItem(a,!0),r(t,e)}))},error:function(t,e,n){if(r({msg:n,xhr:t},null),!o)return Promise.reject(n)}})};return null!=l[a]?""!==l[a]?i(e,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n)):c(a,function(t){return""!==t?i(e,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n))})},getIndex:function(e,o){var n,r=function(t,e){if(o)return o(t,e)},i=function(e,r){var n="".concat(l[a],"/").concat(e),t=u[a]||!1;return $.ajax({type:"GET",dataType:"text",url:n,xhrFields:{withCredentials:t},success:function(t){return"Login Required"!==t.title||n.includes("login-required")||!0===u[a]?(r(null,t),o?void 0:Promise.resolve(t)):(u[a]=!0,i(e,function(t,e){return t?u[a]=!1:d.setItem(a,!0),r(t,e)}))},error:function(t,e,n){if(r({msg:n,xhr:t},null),!o)return Promise.reject(n)}})};return null!=l[a]?""!==l[a]?i(e,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n)):c(a,function(t){return""!==t?i(e,r):(console.log("".concat(a," is unreachable")),n={msg:"".concat(a," is unreachable"),xhr:{status:0}},r(n,null),o?void 0:Promise.reject(n))})},refresh:function(n){var r,o;return console.log("Refreshing ".concat(a)),null==f[a]&&(o=e(a),f[a]=o,r=l[a]+"/favicon.png",$('img[src="'+r+'"]').attr("src",o),$('a[target="'+a+'"]').attr("style","background-image: url("+o+")")),l[a]=null,s.removeItem(a).then(function(){return i.push({site:a},function(e){return s.setItem(a,e).then(function(t){return""===e?console.log("Refreshed prefix for ".concat(a," is undetermined...")):(console.log("Refreshed prefix for ".concat(a," is ").concat(e)),o=f[a],r=l[a]+"/favicon.png",$('img[src="'+o+'"]').attr("src",r),$('a[target="'+a+'"]').attr("style","background-image: url("+r+")")),n()}).catch(function(t){return console.log("findAdapter setItem error: ",a,t),l[a]="",n()})})}).catch(function(t){return console.log("refresh error ",a,t),n()})}}):r.origin}},{"async/queue":46,localforage:48}],34:[function(t,e,n){"use strict";var d,c=[].indexOf,h=t("./active"),p=t("./lineup"),g=null;e.exports=d={},d.inject=function(t){return g=t},d.pagesInDom=function(){return $.makeArray($(".page").map(function(t,e){return e.id}))},d.urlPages=function(){var o;return function(){for(var t=$(location).attr("pathname").split("/"),e=[],n=0,r=t.length;n<r;n+=2)o=t[n],e.push(o);return e}().slice(1)},d.locsInDom=function(){return $.makeArray($(".page").map(function(t,e){return $(e).data("site")||"view"}))},d.urlLocs=function(){for(var t,e=$(location).attr("pathname").split("/").slice(1),n=[],r=0,o=e.length;r<o;r+=2)t=e[r],n.push(t);return n},d.setUrl=function(){var r,o,i,a,t;if(document.title=p.bestTitle(),history&&history.pushState&&(o=d.locsInDom(),a=d.pagesInDom(),(t=function(){var t,e,n=[];for(r=t=0,e=a.length;t<e;r=++t)i=a[r],n.push("/".concat((null!=o?o[r]:void 0)||"view","/").concat(i));return n}().join(""))!==$(location).attr("pathname")))return history.pushState(null,null,t)},d.debugStates=function(){var o;return console.log("a .page keys ",function(){for(var t=$(".page"),e=[],n=0,r=t.length;n<r;n++)o=t[n],e.push($(o).data("key"));return e}()),console.log("a lineup keys",p.debugKeys())},d.show=function(t){var e,n,r,o,i,a,u,c,s=d.pagesInDom(),l=d.urlPages(),f=(d.locsInDom(),d.urlLocs());if(location.pathname&&"/"!==location.pathname){for(a=!0,e=n=0,o=s.length;n<o;e=++n)u=s[e],(a=a&&u===l[e])||(c=$(".page:last"),p.removeKey(c.data("key")),c.remove());for(a=!0,e=r=0,i=l.length;r<i;e=++r)u=l[e],(a=a&&u===s[e])||(console.log("push",e,u),g.showPage(u,f[e]));return d.debugStates(),h.set($(".page").last()),document.title=p.bestTitle()}},d.first=function(){var t,e,n,r,o,i,a,u;for(d.setUrl(),e=d.urlPages(),t=d.urlLocs(),i=d.pagesInDom(),a=[],n=r=0,o=e.length;r<o;n=++r)u=e[n],c.call(i,u)<0&&(""!==u?a.push(g.createPage(u,t[n])):a.push(void 0));return a}},{"./active":3,"./lineup":16}],35:[function(t,e,n){"use strict";e.exports=function(t){var e,n,r=t.synopsis;return(r=(r=null!=t&&null!=t.story?(e=t.story[0],n=t.story[1],e&&"paragraph"===e.type&&(r=r||e.text),n&&"paragraph"===n.type&&(r=r||n.text),e&&null!=e.text&&(r=r||e.text),(r=n&&null!=n.text?r||n.text:r)||null!=t.story&&"A page with ".concat(t.story.length," items.")):"A page with no story.").trim().split(/\r|\n/,1)[0]).substring(0,560)}},{}],36:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=!1,a=null,u=null,c=null,s=null,l=function(t){if((i=t.shiftKey)&&($(".emit").addClass("highlight"),(t=a||c)&&$("[data-id=".concat(t,"]")).addClass("target"),u&&(s=u.consuming)))return s.forEach(function(t){return h(t).addClass("consumed")})},f=function(t){if(!(i=t.shiftKey))return $(".emit").removeClass("highlight"),$(".item, .action").removeClass("target"),$(".item").removeClass("consumed")},d=function(n){var t=$(".page").filter(function(t,e){return $(e).data("key")===n});return 0===t.length?null:(1<t.length&&console.log("warning: more than one page found for",key,t),t)},h=function(t){var e=r(t.split("/"),2),n=e[0],e=e[1],n=d(n);return!n||0===(e=n.find(".item[data-id=".concat(e,"]"))).length?null:(1<e.length&&console.log("warning: more than one item found for",t,e),e)},p=function(t){var e,n;if(a=(n=$(this)).attr("data-id"),u=n[0],i&&($("[data-id=".concat(a,"]")).addClass("target"),e=$(this).parents(".page:first").data("key"),n=n.offset().top,$(".page").trigger("align-item",{key:e,id:a,place:n}),s=u.consuming))return s.forEach(function(t){return h(t).addClass("consumed")})},g=function(t){return i&&($(".item, .action").removeClass("target"),$(".item").removeClass("consumed")),u=a=null},v=function(t){var e;if(c=$(this).data("id"),i)return $("[data-id=".concat(c,"]")).addClass("target"),e=$(this).parents(".page:first").data("key"),$(".page").trigger("align-item",{key:e,id:c})},m=function(t){return i&&$("[data-id=".concat(c,"]")).removeClass("target"),c=null},y=function(t){var e,n;if(a=(n=$(this)).attr("data-id"),u=n[0],i)return $("[data-id=".concat(a,"]")).addClass("target"),e=$(this).parents(".page:first").data("key"),n=n.offset().top,$(".page").trigger("align-item",{key:e,id:a,place:n})},b=function(t){return i&&$(".item, .action").removeClass("target"),u=a=null},w=function(t,e){var n,r=$(this);if(r.data("key")!==e.key&&(n=r.find(".item[data-id=".concat(e.id,"]"))).length)return e=e.place||r.height()/2,e=n.offset().top+r.scrollTop()-e,r.stop().animate({scrollTop:e},"slow")};e.exports={bind:function(){return $(document).keydown(function(t){if(16===t.keyCode)return l(t)}).keyup(function(t){if(16===t.keyCode)return f(t)}),$(".main").delegate(".item","mouseenter",p).delegate(".item","mouseleave",g).delegate(".action","mouseenter",v).delegate(".action","mouseleave",m).delegate(".page","align-item",w).delegate(".backlinks .remote","mouseenter",y).delegate(".backlinks .remote","mouseleave",b)}}},{}],37:[function(t,e,n){"use strict";e.exports=e={},e.formatTime=function(t){var e=new Date(1e10<t?t:1e3*t),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],r=e.getHours(),o=r<12?"AM":"PM";return r=0===r?12:12<r?r-12:r,t=(e.getMinutes()<10?"0":"")+e.getMinutes(),"".concat(r,":").concat(t," ").concat(o,"<br>").concat(e.getDate()," ").concat(n," ").concat(e.getFullYear())},e.formatDate=function(t){var e=new Date(t),n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate(),i=e.getFullYear(),a=e.getHours(),u=a<12?"AM":"PM";return a=0===a?12:12<a?a-12:a,t=(e.getMinutes()<10?"0":"")+e.getMinutes(),e=(e.getSeconds()<10?"0":"")+e.getSeconds(),"".concat(n," ").concat(r," ").concat(o,", ").concat(i,"<br>").concat(a,":").concat(t,":").concat(e," ").concat(u)},e.formatElapsedTime=function(t){var e,n=(new Date).getTime()-t;return(e=n/1e3)<2?"".concat(Math.floor(n)," milliseconds ago"):(t=e/60)<2?"".concat(Math.floor(e)," seconds ago"):(n=t/60)<2?"".concat(Math.floor(t)," minutes ago"):(e=n/24)<2?"".concat(Math.floor(n)," hours ago"):(t=e/7)<2?"".concat(Math.floor(e)," days ago"):(n=e/31)<2?"".concat(Math.floor(t)," weeks ago"):(e=e/365)<2?"".concat(Math.floor(n)," months ago"):"".concat(Math.floor(e)," years ago")}},{}],38:[function(t,e,n){"use strict";var r={},o=t("./siteAdapter");r.local=o.local,r.origin=o.origin,r.recycler=o.recycler,r.site=o.site,r.asSlug=t("./page").asSlug,r.newPage=t("./page").newPage,o=t("./itemz"),r.removeItem=o.removeItem,r.createItem=o.createItem,r.getItem=o.getItem,o=t("./dialog"),r.dialog=o.open,o=t("./link"),r.createPage=o.createPage,r.doInternalLink=o.doInternalLink,r.showResult=o.showResult,o=t("./plugin"),r.getScript=o.getScript,r.getPlugin=o.getPlugin,r.doPlugin=o.doPlugin,r.registerPlugin=o.registerPlugin,r.getData=function(t){var e;return t?(e=$(".item").index(t),null!=(e=$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").last())?e.data("item").data:{}):null!=(e=$(".chart,.data,.calculator").last())?e.data("item").data:{}},r.getDataNodes=function(t){var e=t?(e=$(".item").index(t),$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").toArray().reverse()):$(".chart,.data,.calculator").toArray().reverse();return $(e)},r.log=function(){var t;if(null!=("undefined"!=typeof console&&null!==console?console.log:void 0))return(t=console).log.apply(t,arguments)},o=t("./neighborhood"),r.neighborhood=o.sites,r.neighborhoodObject=o,o=t("./pageHandler"),r.pageHandler=o,r.useLocalStorage=o.useLocalStorage,o=t("./resolve"),r.resolveFrom=o.resolveFrom,r.resolveLinks=o.resolveLinks,r.resolutionContext=o.resolutionContext,o=t("./editor"),r.textEditor=o.textEditor,r.util=t("./util"),r.security=t("./security"),r.createSynopsis=t("./synopsis"),r.lineup=t("./lineup"),e.exports=r},{"./dialog":6,"./editor":8,"./itemz":13,"./lineup":16,"./link":17,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./resolve":28,"./security":32,"./siteAdapter":33,"./synopsis":35,"./util":37}],39:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(r){if((0,i.isAsync)(r))return function(...t){var e=t.pop();return u(r.apply(this,t),e)};return(0,o.default)(function(t,e){var n;try{n=r.apply(this,t)}catch(t){return e(t)}if(n&&"function"==typeof n.then)return u(n,e);e(null,n)})};var o=a(t("./internal/initialParams")),r=a(t("./internal/setImmediate")),i=t("./internal/wrapAsync");function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return t.then(t=>{c(e,null,t)},t=>{c(e,t&&t.message?t:new Error(t))})}function c(t,e,n){try{t(e,n)}catch(t){(0,r.default)(t=>{throw t},t)}}e.exports=n.default},{"./internal/initialParams":41,"./internal/setImmediate":44,"./internal/wrapAsync":45}],40:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r{constructor(){this.head=this.tail=null,this.length=0}removeLink(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,--this.length,t}empty(){for(;this.head;)this.shift();return this}insertAfter(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1}insertBefore(t,e){e.prev=t.prev,(e.next=t).prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1}unshift(t){this.head?this.insertBefore(this.head,t):o(this,t)}push(t){this.tail?this.insertAfter(this.tail,t):o(this,t)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var t=this.head;t;)yield t.data,t=t.next}remove(t){for(var e=this.head;e;){var n=e["next"];t(e)&&this.removeLink(e),e=n}return this}}function o(t,e){t.length=1,t.head=t.tail=e}n.default=r,e.exports=n.default},{}],41:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){return function(...t){var e=t.pop();return n.call(this,t,e)}},e.exports=n.default},{}],42:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){return function(...t){if(null===n)throw new Error("Callback was already called.");var e=n;n=null,e.apply(this,t)}},e.exports=n.default},{}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,n){if(null==e)e=1;else if(0===e)throw new RangeError("Concurrency must not be zero");var a=(0,m.default)(t),u=0,c=[];const i={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function s(t,e){return t?e?void(i[t]=i[t].filter(t=>t!==e)):i[t]=[]:Object.keys(i).forEach(t=>i[t]=[])}function l(t,...e){i[t].forEach(t=>t(...e))}var f=!1;function r(t,e,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");var o,i;function a(t,...e){return t?n?i(t):o():e.length<=1?o(e[0]):void o(e)}h.started=!0;t={data:t,callback:!n&&r||a};if(e?h._tasks.unshift(t):h._tasks.push(t),f||(f=!0,(0,g.default)(()=>{f=!1,h.process()})),n||!r)return new Promise((t,e)=>{o=t,i=e})}function o(t){return 0===t.length&&h.idle()&&((0,g.default)(()=>l("drain")),1)}t=o=>t=>{if(!t)return new Promise((n,r)=>{!function(e,n){const r=(...t)=>{s(e,r),n(...t)};i[e].push(r)}(o,(t,e)=>t?r(t):void n(e))});var e;s(o),e=o,t=t,i[e].push(t)};var d=!1,h={_tasks:new v.default,*[Symbol.iterator](){yield*h._tasks[Symbol.iterator]()},concurrency:e,payload:n,buffer:e/4,started:!1,paused:!1,push(t,e){return Array.isArray(t)?o(t)?void 0:t.map(t=>r(t,!1,!1,e)):r(t,!1,!1,e)},pushAsync(t,e){return Array.isArray(t)?o(t)?void 0:t.map(t=>r(t,!1,!0,e)):r(t,!1,!0,e)},kill(){s(),h._tasks.empty()},unshift(t,e){return Array.isArray(t)?o(t)?void 0:t.map(t=>r(t,!0,!1,e)):r(t,!0,!1,e)},unshiftAsync(t,e){return Array.isArray(t)?o(t)?void 0:t.map(t=>r(t,!0,!0,e)):r(t,!0,!0,e)},remove(t){h._tasks.remove(t)},process(){if(!d){for(d=!0;!h.paused&&u<h.concurrency&&h._tasks.length;){var t=[],e=[],n=h._tasks.length;h.payload&&(n=Math.min(n,h.payload));for(var r=0;r<n;r++){var o=h._tasks.shift();t.push(o),c.push(o),e.push(o.data)}u+=1,0===h._tasks.length&&l("empty"),u===h.concurrency&&l("saturated");var i=(0,p.default)(function(a){return function(t,...e){--u;for(var n=0,r=a.length;n<r;n++){var o=a[n],i=c.indexOf(o);0===i?c.shift():0<i&&c.splice(i,1),o.callback(t,...e),null!=t&&l("error",t,o.data)}u<=h.concurrency-h.buffer&&l("unsaturated"),h.idle()&&l("drain"),h.process()}}(t));a(e,i)}d=!1}},length(){return h._tasks.length},running(){return u},workersList(){return c},idle(){return h._tasks.length+u===0},pause(){h.paused=!0},resume(){!1!==h.paused&&(h.paused=!1,g.default)(h.process)}};return Object.defineProperties(h,{saturated:{writable:!1,value:t("saturated")},unsaturated:{writable:!1,value:t("unsaturated")},empty:{writable:!1,value:t("empty")},drain:{writable:!1,value:t("drain")},error:{writable:!1,value:t("error")}}),h};var p=r(t("./onlyOnce")),g=r(t("./setImmediate")),v=r(t("./DoublyLinkedList")),m=r(t("./wrapAsync"));function r(t){return t&&t.__esModule?t:{default:t}}e.exports=n.default},{"./DoublyLinkedList":40,"./onlyOnce":42,"./setImmediate":44,"./wrapAsync":45}],44:[function(t,e,u){!function(i,a){!function(){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.fallback=r,u.wrap=o;var t=u.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,e=u.hasSetImmediate="function"==typeof a&&a,n=u.hasNextTick="object"==typeof i&&"function"==typeof i.nextTick;function r(t){setTimeout(t,0)}function o(n){return(t,...e)=>n(()=>t(...e))}n=t?queueMicrotask:e?a:n?i.nextTick:r,u.default=o(n)}.call(this)}.call(this,t("_process"),t("timers").setImmediate)},{_process:50,timers:55}],45:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isAsyncIterable=n.isAsyncGenerator=n.isAsync=void 0;var t=t("../asyncify"),r=(t=t)&&t.__esModule?t:{default:t};function o(t){return"AsyncFunction"===t[Symbol.toStringTag]}n.default=function(t){if("function"!=typeof t)throw new Error("expected a function");return o(t)?(0,r.default)(t):t},n.isAsync=o,n.isAsyncGenerator=function(t){return"AsyncGenerator"===t[Symbol.toStringTag]},n.isAsyncIterable=function(t){return"function"==typeof t[Symbol.asyncIterator]}},{"../asyncify":39}],46:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){var n=(0,o.default)(t);return(0,r.default)((t,e)=>{n(t[0],e)},e,1)};var r=i(t("./internal/queue")),o=i(t("./internal/wrapAsync"));function i(t){return t&&t.__esModule?t:{default:t}}e.exports=n.default},{"./internal/queue":43,"./internal/wrapAsync":45}],47:[function(t,e,n){"use strict";var r="object"==typeof Reflect?Reflect:null,c=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};var o=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)},i=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(u,c){return new Promise(function(t,e){function n(t){u.removeListener(c,r),e(t)}function r(){"function"==typeof u.removeListener&&u.removeListener("error",n),t([].slice.call(arguments))}var o,i,a;v(u,c,r,{once:!0}),"error"!==c&&(i=n,a={once:!0},"function"==typeof(o=u).on&&v(o,"error",i,a))})},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function s(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var o,i;return s(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener||n),o=t._events),i=o[e]),void 0===i?(i=o[e]=n,++t._eventsCount):("function"==typeof i?i=o[e]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),0<(n=l(t))&&i.length>n&&!i.warned&&(i.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=i.length,n=n,console&&console.warn&&console.warn(n))),t}function d(t,e,n){t={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},e=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(t);return e.listener=n,t.wrapFn=e}function h(t,e,n){t=t._events;if(void 0===t)return[];e=t[e];return void 0===e?[]:"function"==typeof e?n?[e.listener||e]:[e]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):g(e,e.length)}function p(t){var e=this._events;if(void 0!==e){t=e[t];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function g(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function v(n,r,o,i){if("function"==typeof n.on)i.once?n.once(r,o):n.on(r,o);else{if("function"!=typeof n.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n);n.addEventListener(r,function t(e){i.once&&n.removeEventListener(r,t),o(e)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r,o="error"===t,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){if((r=0<e.length?e[0]:r)instanceof Error)throw r;o=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw o.context=r,o}t=i[t];if(void 0===t)return!1;if("function"==typeof t)c(t,this,e);else for(var a=t.length,u=g(t,a),n=0;n<a;++n)c(u[n],this,e);return!0},a.prototype.on=a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){return s(e),this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return s(e),this.prependListener(t,d(this,t,e)),this},a.prototype.off=a.prototype.removeListener=function(t,e){var n,r,o,i,a;if(s(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;0<=i;i--)if(n[i]===e||n[i].listener===e){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},a.prototype.removeAllListeners=function(t){var e,n=this._events;if(void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return h(this,t,!0)},a.prototype.rawListeners=function(t){return h(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},{}],48:[function(s,e,n){!function(r){!function(){!function(t){"object"==typeof n&&void 0!==e?e.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=t()}(function(){return function r(o,i,a){function u(n,t){if(!i[n]){if(!o[n]){var e="function"==typeof s&&s;if(!t&&e)return e(n,!0);if(c)return c(n,!0);e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}e=i[n]={exports:{}};o[n][0].call(e.exports,function(t){var e=o[n][1][t];return u(e||t)},e,e.exports,r,o,i,a)}return i[n].exports}for(var c="function"==typeof s&&s,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,s,e){!function(e){"use strict";var t,n,r,o,i=e.MutationObserver||e.WebKitMutationObserver,a=i?(t=0,i=new i(c),n=e.document.createTextNode(""),i.observe(n,{characterData:!0}),function(){n.data=t=++t%2}):e.setImmediate||void 0===e.MessageChannel?"document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)}:((r=new e.MessageChannel).port1.onmessage=c,function(){r.port2.postMessage(0)}),u=[];function c(){var t,e;o=!0;for(var n=u.length;n;){for(e=u,u=[],t=-1;++t<n;)e[t]();n=u.length}o=!1}s.exports=function(t){1!==u.push(t)||o||a()}}.call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var o=t(1);function c(){}var s={},i=["REJECTED"],a=["FULFILLED"],r=["PENDING"];function u(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,t!==c&&h(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(e,n,r){o(function(){var t;try{t=n(r)}catch(t){return s.reject(e,t)}t===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,t)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,s.reject(e,t))}function o(t){n||(n=!0,s.resolve(e,t))}var i=p(function(){t(o,r)});"error"===i.status&&r(i.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}(e.exports=u).prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===i)return this;var n=new this.constructor(c);return this.state!==r?f(n,this.state===a?t:e,this.outcome):this.queue.push(new l(n,t,e)),n},l.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){s.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},s.resolve=function(t,e){var n=p(d,e);if("error"===n.status)return s.reject(t,n.value);n=n.value;if(n)h(t,n);else{t.state=a,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},s.reject=function(t,e){t.state=i,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},u.resolve=function(t){if(t instanceof this)return t;return s.resolve(new this(c),t)},u.reject=function(t){var e=new this(c);return s.reject(e,t)},u.all=function(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,o=!1;if(!r)return this.resolve([]);var i=new Array(r),a=0,e=-1,u=new this(c);for(;++e<r;)!function(t,e){n.resolve(t).then(function(t){i[e]=t,++a!==r||o||(o=!0,s.resolve(u,i))},function(t){o||(o=!0,s.reject(u,t))})}(t[e],e);return u},u.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=-1,i=new this(c);for(;++o<n;)!function(t){e.resolve(t).then(function(t){r||(r=!0,s.resolve(i,t))},function(t){r||(r=!0,s.reject(i,t))})}(t[o]);return i}},{1:1}],3:[function(e,t,n){!function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}.call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var u=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function i(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if("TypeError"!==t.name)throw t;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)r.append(e[o]);return r.getBlob(n.type)}}"undefined"==typeof Promise&&t(3);var l=Promise;function f(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function c(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function d(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function s(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var a="local-forage-detect-blob-support",o=void 0,h={},p=Object.prototype.toString,g="readonly",v="readwrite";function m(t){return"boolean"==typeof o?l.resolve(o):(r=t,new l(function(n){var t=r.transaction(a,v),e=i([""]);t.objectStore(a).put(e,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),n(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);n(e||!t||43<=parseInt(t[1],10))}}).catch(function(){return!1}).then(function(t){return o=t}));var r}function y(t){var t=h[t.name],n={};n.promise=new l(function(t,e){n.resolve=t,n.reject=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function b(t){t=h[t.name].deferredOperations.pop();return t&&(t.resolve(),t.promise)}function w(t,e){t=h[t.name].deferredOperations.pop();if(t)return t.reject(e),t.promise}function x(o,i){return new l(function(e,n){if(h[o.name]=h[o.name]||$(),o.db){if(!i)return e(o.db);y(o),o.db.close()}var t=[o.name];i&&t.push(o.version);var r=u.open.apply(u,t);i&&(r.onupgradeneeded=function(e){var t=r.result;try{t.createObjectStore(o.storeName),e.oldVersion<=1&&t.createObjectStore(a)}catch(t){if("ConstraintError"!==t.name)throw t;console.warn('The database "'+o.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+o.storeName+'" already exists.')}}),r.onerror=function(t){t.preventDefault(),n(r.error)},r.onsuccess=function(){var t=r.result;t.onversionchange=function(t){t.target.close()},e(t),b(o)}})}function k(t){return x(t,!1)}function _(t){return x(t,!0)}function S(t,e){if(!t.db)return 1;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;return r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),(o||n)&&(!n||(n=t.db.version+1)>t.version&&(t.version=n),1)}function I(t){return i([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}(atob(t.data))],{type:t.type})}function j(t){return t&&t.__local_forage_encoded_blob}function E(t){var e=this,n=e._initReady().then(function(){var t=h[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return c(n,t,t),n}function A(e,n,r,o){void 0===o&&(o=1);try{var t=e.db.transaction(e.storeName,n);r(null,t)}catch(t){if(0<o&&(!e.db||"InvalidStateError"===t.name||"NotFoundError"===t.name))return l.resolve().then(function(){if(!e.db||"NotFoundError"===t.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),_(e)}).then(function(){return function(n){y(n);for(var r=h[n.name],o=r.forages,t=0;t<o.length;t++){var e=o[t];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return n.db=null,k(n).then(function(t){return n.db=t,S(n)?_(n):t}).then(function(t){n.db=r.db=t;for(var e=0;e<o.length;e++)o[e]._dbInfo.db=t}).catch(function(t){throw w(n,t),t})}(e).then(function(){A(e,n,r,o-1)})}).catch(r);r(t)}}function $(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}var C={_driver:"asyncStorage",_initStorage:function(t){var r=this,o={db:null};if(t)for(var e in t)o[e]=t[e];var i=h[o.name];i||(i=$(),h[o.name]=i),i.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=E);var n=[];function a(){return l.resolve()}for(var u=0;u<i.forages.length;u++){var c=i.forages[u];c!==r&&n.push(c._initReady().catch(a))}var s=i.forages.slice(0);return l.all(n).then(function(){return o.db=i.db,k(o)}).then(function(t){return o.db=t,S(o,r._defaultConfig.version)?_(o):t}).then(function(t){o.db=i.db=t,r._dbInfo=o;for(var e=0;e<s.length;e++){var n=s[e];n!==r&&(n._dbInfo.db=o.db,n._dbInfo.version=o.version)}})},_support:function(){try{if(!u||!u.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(a,t){var u=this,e=new l(function(o,i){u.ready().then(function(){A(u._dbInfo,g,function(t,e){if(t)return i(t);try{var n=e.objectStore(u._dbInfo.storeName).openCursor(),r=1;n.onsuccess=function(){var t,e=n.result;e?(j(t=e.value)&&(t=I(t)),void 0!==(t=a(t,e.key,r++))?o(t):e.continue()):o()},n.onerror=function(){i(n.error)}}catch(t){i(t)}})}).catch(i)});return f(e,t),e},getItem:function(i,t){var a=this;i=d(i);var e=new l(function(r,o){a.ready().then(function(){A(a._dbInfo,g,function(t,e){if(t)return o(t);try{var n=e.objectStore(a._dbInfo.storeName).get(i);n.onsuccess=function(){var t=n.result;j(t=void 0===t?null:t)&&(t=I(t)),r(t)},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return f(e,t),e},setItem:function(u,e,t){var c=this;u=d(u);var n=new l(function(i,a){var t;c.ready().then(function(){return t=c._dbInfo,"[object Blob]"===p.call(e)?m(t.db).then(function(t){return t?e:(r=e,new l(function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){t=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:t,type:r.type})},n.readAsBinaryString(r)}));var r}):e}).then(function(o){A(c._dbInfo,v,function(t,e){if(t)return a(t);try{var n=e.objectStore(c._dbInfo.storeName);null===o&&(o=void 0);var r=n.put(o,u);e.oncomplete=function(){i(o=void 0===o?null:o)},e.onabort=e.onerror=function(){var t=r.error||r.transaction.error;a(t)}}catch(t){a(t)}})}).catch(a)});return f(n,t),n},removeItem:function(i,t){var a=this;i=d(i);var e=new l(function(r,o){a.ready().then(function(){A(a._dbInfo,v,function(t,e){if(t)return o(t);try{var n=e.objectStore(a._dbInfo.storeName).delete(i);e.oncomplete=function(){r()},e.onerror=function(){o(n.error)},e.onabort=function(){var t=n.error||n.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return f(e,t),e},clear:function(t){var i=this,e=new l(function(r,o){i.ready().then(function(){A(i._dbInfo,v,function(t,e){if(t)return o(t);try{var n=e.objectStore(i._dbInfo.storeName).clear();e.oncomplete=function(){r()},e.onabort=e.onerror=function(){var t=n.error||n.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return f(e,t),e},length:function(t){var i=this,e=new l(function(r,o){i.ready().then(function(){A(i._dbInfo,g,function(t,e){if(t)return o(t);try{var n=e.objectStore(i._dbInfo.storeName).count();n.onsuccess=function(){r(n.result)},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return f(e,t),e},key:function(u,t){var c=this,e=new l(function(i,a){u<0?i(null):c.ready().then(function(){A(c._dbInfo,g,function(t,e){if(t)return a(t);try{var n=e.objectStore(c._dbInfo.storeName),r=!1,o=n.openKeyCursor();o.onsuccess=function(){var t=o.result;t?0===u||r?i(t.key):(r=!0,t.advance(u)):i(null)},o.onerror=function(){a(o.error)}}catch(t){a(t)}})}).catch(a)});return f(e,t),e},keys:function(t){var a=this,e=new l(function(o,i){a.ready().then(function(){A(a._dbInfo,g,function(t,e){if(t)return i(t);try{var n=e.objectStore(a._dbInfo.storeName).openKeyCursor(),r=[];n.onsuccess=function(){var t=n.result;t?(r.push(t.key),t.continue()):o(r)},n.onerror=function(){i(n.error)}}catch(t){i(t)}})}).catch(i)});return f(e,t),e},dropInstance:function(a,t){t=s.apply(this,arguments);var e,n=this.config();return(a="function"!=typeof a&&a||{}).name||(a.name=a.name||n.name,a.storeName=a.storeName||n.storeName),f(e=a.name?(e=a.name===n.name&&this._dbInfo.db?l.resolve(this._dbInfo.db):k(a).then(function(t){var e=h[a.name],n=e.forages;e.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}),a.storeName?e.then(function(t){if(t.objectStoreNames.contains(a.storeName)){var o=t.version+1;y(a);var r=h[a.name],i=r.forages;t.close();for(var e=0;e<i.length;e++){var n=i[e];n._dbInfo.db=null,n._dbInfo.version=o}return new l(function(e,n){var r=u.open(a.name,o);r.onerror=function(t){r.result.close(),n(t)},r.onupgradeneeded=function(){r.result.deleteObjectStore(a.storeName)},r.onsuccess=function(){var t=r.result;t.close(),e(t)}}).then(function(t){r.db=t;for(var e=0;e<i.length;e++){var n=i[e];n._dbInfo.db=t,b(n._dbInfo)}}).catch(function(t){throw(w(a,t)||l.resolve()).catch(function(){}),t})}}):e.then(function(t){y(a);var n=h[a.name],r=n.forages;t.close();for(var e=0;e<r.length;e++)r[e]._dbInfo.db=null;return new l(function(e,n){var r=u.deleteDatabase(a.name);r.onerror=function(){var t=r.result;t&&t.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<r.length;e++)b(r[e]._dbInfo)}).catch(function(t){throw(w(a,t)||l.resolve()).catch(function(){}),t})})):l.reject("Invalid arguments"),t),e}};var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=/^~~local_forage_type~([^~]+)~/,F="__lfsc__:",L=F.length,R="arbf",D="blob",P=L+R.length,N=Object.prototype.toString;function M(t){var e,n,r,o,i=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);for(var i=new ArrayBuffer(i),c=new Uint8Array(i),s=0;s<a;s+=4)e=O.indexOf(t[s]),n=O.indexOf(t[s+1]),r=O.indexOf(t[s+2]),o=O.indexOf(t[s+3]),c[u++]=e<<2|n>>4,c[u++]=(15&n)<<4|r>>2,c[u++]=(3&r)<<6|63&o;return i}function B(t){for(var e=new Uint8Array(t),n="",r=0;r<e.length;r+=3)n+=O[e[r]>>2],n+=O[(3&e[r])<<4|e[r+1]>>4],n+=O[(15&e[r+1])<<2|e[r+2]>>6],n+=O[63&e[r+2]];return e.length%3==2?n=n.substring(0,n.length-1)+"=":e.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var z={serialize:function(e,n){var t="";if(e&&(t=N.call(e)),e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===N.call(e.buffer))){var r,o=F;e instanceof ArrayBuffer?(r=e,o+=R):(r=e.buffer,"[object Int8Array]"===t?o+="si08":"[object Uint8Array]"===t?o+="ui08":"[object Uint8ClampedArray]"===t?o+="uic8":"[object Int16Array]"===t?o+="si16":"[object Uint16Array]"===t?o+="ur16":"[object Int32Array]"===t?o+="si32":"[object Uint32Array]"===t?o+="ui32":"[object Float32Array]"===t?o+="fl32":"[object Float64Array]"===t?o+="fl64":n(new Error("Failed to get type for BinaryArray"))),n(o+B(r))}else if("[object Blob]"===t){t=new FileReader;t.onload=function(){var t="~~local_forage_type~"+e.type+"~"+B(this.result);n(F+D+t)},t.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(t){console.error("Couldn't convert value into a JSON string: ",e),n(null,t)}},deserialize:function(t){if(t.substring(0,L)!==F)return JSON.parse(t);var e,n=t.substring(P),r=t.substring(L,P);r===D&&T.test(n)&&(e=(t=n.match(T))[1],n=n.substring(t[0].length));var o=M(n);switch(r){case R:return o;case D:return i([o],{type:e});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:M,bufferToString:B};function U(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function q(t,r,o,i,a,u){t.executeSql(o,i,a,function(t,n){n.code===n.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(t,e){e.rows.length?u(t,n):U(t,r,function(){t.executeSql(o,i,a,u)},u)},u):u(t,n)},u)}function K(a,t,u,c){var s=this;a=d(a);var e=new l(function(o,i){s.ready().then(function(){var n=t=void 0===t?null:t,r=s._dbInfo;r.serializer.serialize(t,function(e,t){t?i(t):r.db.transaction(function(t){q(t,r,"INSERT OR REPLACE INTO "+r.storeName+" (key, value) VALUES (?, ?)",[a,e],function(){o(n)},function(t,e){i(e)})},function(t){t.code===t.QUOTA_ERR&&(0<c?o(K.apply(s,[a,n,u,c-1])):i(t))})})}).catch(i)});return f(e,u),e}var W={_driver:"webSQLStorage",_initStorage:function(t){var r=this,o={db:null};if(t)for(var e in t)o[e]="string"!=typeof t[e]?t[e].toString():t[e];var n=new l(function(e,n){try{o.db=openDatabase(o.name,String(o.version),o.description,o.size)}catch(t){return n(t)}o.db.transaction(function(t){U(t,o,function(){r._dbInfo=o,e()},function(t,e){n(e)})},n)});return o.serializer=z,n},_support:"function"==typeof openDatabase,iterate:function(s,t){var e=this,n=new l(function(c,n){e.ready().then(function(){var u=e._dbInfo;u.db.transaction(function(t){q(t,u,"SELECT * FROM "+u.storeName,[],function(t,e){for(var n=e.rows,r=n.length,o=0;o<r;o++){var i=n.item(o),a=(a=i.value)&&u.serializer.deserialize(a);if(void 0!==(a=s(a,i.key,o+1)))return void c(a)}c()},function(t,e){n(e)})})}).catch(n)});return f(n,t),n},getItem:function(e,t){var i=this;e=d(e);var n=new l(function(r,o){i.ready().then(function(){var n=i._dbInfo;n.db.transaction(function(t){q(t,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[e],function(t,e){e=(e=e.rows.length?e.rows.item(0).value:null)&&n.serializer.deserialize(e);r(e)},function(t,e){o(e)})})}).catch(o)});return f(n,t),n},setItem:function(t,e,n){return K.apply(this,[t,e,n,1])},removeItem:function(o,t){var i=this;o=d(o);var e=new l(function(n,r){i.ready().then(function(){var e=i._dbInfo;e.db.transaction(function(t){q(t,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[o],function(){n()},function(t,e){r(e)})})}).catch(r)});return f(e,t),e},clear:function(t){var o=this,e=new l(function(n,r){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){q(t,e,"DELETE FROM "+e.storeName,[],function(){n()},function(t,e){r(e)})})}).catch(r)});return f(e,t),e},length:function(t){var o=this,e=new l(function(n,r){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){q(t,e,"SELECT COUNT(key) as c FROM "+e.storeName,[],function(t,e){e=e.rows.item(0).c;n(e)},function(t,e){r(e)})})}).catch(r)});return f(e,t),e},key:function(o,t){var i=this,e=new l(function(n,r){i.ready().then(function(){var e=i._dbInfo;e.db.transaction(function(t){q(t,e,"SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[o+1],function(t,e){e=e.rows.length?e.rows.item(0).key:null;n(e)},function(t,e){r(e)})})}).catch(r)});return f(e,t),e},keys:function(t){var r=this,e=new l(function(o,n){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){q(t,e,"SELECT key FROM "+e.storeName,[],function(t,e){for(var n=[],r=0;r<e.rows.length;r++)n.push(e.rows.item(r).key);o(n)},function(t,e){n(e)})})}).catch(n)});return f(e,t),e},dropInstance:function(n,t){t=s.apply(this,arguments);var r=this.config();(n="function"!=typeof n&&n||{}).name||(n.name=n.name||r.name,n.storeName=n.storeName||r.storeName);var o=this,e=n.name?new l(function(t){var i,e=n.name===r.name?o._dbInfo.db:openDatabase(n.name,"","",0);n.storeName?t({db:e,storeNames:[n.storeName]}):t((i=e,new l(function(o,n){i.transaction(function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,e){for(var n=[],r=0;r<e.rows.length;r++)n.push(e.rows.item(r).name);o({db:i,storeNames:n})},function(t,e){n(e)})},function(t){n(t)})})))}).then(function(a){return new l(function(o,i){a.db.transaction(function(r){for(var t=[],e=0,n=a.storeNames.length;e<n;e++)t.push(function(e){return new l(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(t,e){n(e)})})}(a.storeNames[e]));l.all(t).then(function(){o()}).catch(function(t){i(t)})},function(t){i(t)})})}):l.reject("Invalid arguments");return f(e,t),e}};function H(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function J(){return!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),void localStorage.removeItem(t)}catch(t){return 1}}()||0<localStorage.length}function G(t,e){for(var n,r,o=t.length,i=0;i<o;){if((n=t[i])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return 1;i++}}var t={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=H(t,this._defaultConfig),J()?((this._dbInfo=e).serializer=z,l.resolve()):l.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(c,t){var s=this,e=s.ready().then(function(){for(var t=s._dbInfo,e=t.keyPrefix,n=e.length,r=localStorage.length,o=1,i=0;i<r;i++){var a=localStorage.key(i);if(0===a.indexOf(e)){var u=(u=localStorage.getItem(a))&&t.serializer.deserialize(u);if(void 0!==(u=c(u,a.substring(n),o++)))return u}}});return f(e,t),e},getItem:function(n,t){var r=this;n=d(n);var e=r.ready().then(function(){var t=r._dbInfo,e=localStorage.getItem(t.keyPrefix+n);return e=e&&t.serializer.deserialize(e)});return f(e,t),e},setItem:function(a,t,e){var u=this;a=d(a);var n=u.ready().then(function(){var i=t=void 0===t?null:t;return new l(function(n,r){var o=u._dbInfo;o.serializer.serialize(t,function(t,e){if(e)r(e);else try{localStorage.setItem(o.keyPrefix+a,t),n(i)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||r(t),r(t)}})})});return f(n,e),n},removeItem:function(e,t){var n=this;e=d(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return f(r,t),r},clear:function(t){var r=this,e=r.ready().then(function(){for(var t=r._dbInfo.keyPrefix,e=localStorage.length-1;0<=e;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}});return f(e,t),e},length:function(t){var e=this.keys().then(function(t){return t.length});return f(e,t),e},key:function(n,t){var r=this,e=r.ready().then(function(){var e,t=r._dbInfo;try{e=localStorage.key(n)}catch(t){e=null}return e=e&&e.substring(t.keyPrefix.length)});return f(e,t),e},keys:function(t){var i=this,e=i.ready().then(function(){for(var t=i._dbInfo,e=localStorage.length,n=[],r=0;r<e;r++){var o=localStorage.key(r);0===o.indexOf(t.keyPrefix)&&n.push(o.substring(t.keyPrefix.length))}return n});return f(e,t),e},dropInstance:function(e,t){t=s.apply(this,arguments),(e="function"!=typeof e&&e||{}).name||(r=this.config(),e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n=this,r=e.name?new l(function(t){e.storeName?t(H(e,n._defaultConfig)):t(e.name+"/")}).then(function(t){for(var e=localStorage.length-1;0<=e;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):l.reject("Invalid arguments");return f(r,t),r}},V=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Y={},Q={},X={INDEXEDDB:C,WEBSQL:W,LOCALSTORAGE:t},t=[X.INDEXEDDB._driver,X.WEBSQL._driver,X.LOCALSTORAGE._driver],Z=["dropInstance"],tt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Z),et={description:"",driver:t.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function nt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(V(n[r])?t[r]=n[r].slice():t[r]=n[r])}return t}function rt(t){for(var e in!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,rt),X){var n,r;X.hasOwnProperty(e)&&(r=(n=X[e])._driver,this[e]=r,Y[r]||this.defineDriver(n))}this._defaultConfig=nt({},et),this._config=nt({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}t=new(rt.prototype.config=function(t){if("object"!==(void 0===t?"undefined":r(t)))return"string"==typeof t?this._config[t]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)},rt.prototype.defineDriver=function(s,t,e){var n=new l(function(e,n){try{var r=s._driver,t=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!s._driver)return void n(t);for(var o=tt.concat("_initStorage"),i=0,a=o.length;i<a;i++){var u=o[i];if((!G(Z,u)||s[u])&&"function"!=typeof s[u])return void n(t)}!function(){for(var t=0,e=Z.length;t<e;t++){var n=Z[t];s[n]||(s[n]=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),t=l.reject(t);return f(t,arguments[arguments.length-1]),t}}(n))}}();var c=function(t){Y[r]&&console.info("Redefining LocalForage driver: "+r),Y[r]=s,Q[r]=t,e()};"_support"in s?s._support&&"function"==typeof s._support?s._support().then(c,n):c(!!s._support):c(!0)}catch(t){n(t)}});return c(n,t,e),n},rt.prototype.driver=function(){return this._driver||null},rt.prototype.getDriver=function(t,e,n){t=Y[t]?l.resolve(Y[t]):l.reject(new Error("Driver not found."));return c(t,e,n),t},rt.prototype.getSerializer=function(t){var e=l.resolve(z);return c(e,t),e},rt.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return c(n,t,t),n},rt.prototype.setDriver=function(t,e,n){var i=this;V(t)||(t=[t]);var r=this._getSupportedDrivers(t);function a(){i._config.driver=i.driver()}function u(t){return i._extend(t),a(),i._ready=i._initStorage(i._config),i._ready}function o(o){return function(){var r=0;return function t(){for(;r<o.length;){var e=o[r];return r++,i._dbInfo=null,i._ready=null,i.getDriver(e).then(u).catch(t)}a();var n=new Error("No available storage method found.");return i._driverSet=l.reject(n),i._driverSet}()}}t=null!==this._driverSet?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=t.then(function(){var t=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,a(),i._wrapLibraryMethodsWithReady(),i._initDriver=o(r)})}).catch(function(){a();var t=new Error("No available storage method found.");return i._driverSet=l.reject(t),i._driverSet}),c(this._driverSet,e,n),this._driverSet},rt.prototype.supports=function(t){return!!Q[t]},rt.prototype._extend=function(t){nt(this,t)},rt.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},rt.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=tt.length;t<e;t++)!function(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}(this,tt[t])},rt.prototype.createInstance=function(t){return new rt(t)},rt);e.exports=t},{3:3}]},{},[4])(4)})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(t,e,n){var r,o;r=this,o=function(){"use strict";var l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function a(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}var t=(e.prototype.next=function(){var t=this.dive();return this.backtrack(),t},e.prototype.dive=function(){if(0===this._path.length)return{done:!0,value:void 0};var t=r(this._path),e=t.node,t=t.keys;return""===r(t)?{done:!1,value:this.result()}:(this._path.push({node:e[r(t)],keys:Object.keys(e[r(t)])}),this.dive())},e.prototype.backtrack=function(){0!==this._path.length&&(r(this._path).keys.pop(),0<r(this._path).keys.length||(this._path.pop(),this.backtrack()))},e.prototype.key=function(){return this.set._prefix+this._path.map(function(t){t=t.keys;return r(t)}).filter(function(t){return""!==t}).join("")},e.prototype.value=function(){return r(this._path).node[""]},e.prototype.result=function(){return"VALUES"===this._type?this.value():"KEYS"===this._type?this.key():[this.key(),this.value()]},e.prototype[Symbol.iterator]=function(){return this},e);function e(t,e){var n=t._tree,r=Object.keys(n);this.set=t,this._type=e,this._path=0<r.length?[{node:n,keys:r}]:[]}function n(t,c,s){for(var l=[{distance:0,i:0,key:"",node:t}],f={},d=[],e=function(){var t=l.pop(),o=t.node,i=t.distance,a=t.key,n=t.i,u=t.edit;Object.keys(o).forEach(function(r){var t,e;""===r?(t=i+(c.length-n),e=h(f[a]||[null,1/0],2)[1],t<=s&&t<e&&(f[a]=[o[r],t])):function(t,e,n,r,o,i){i.push({distance:0,ia:r,ib:0,edit:o});var a=[];while(i.length>0){var u=i.pop(),c=u.distance,s=u.ia,l=u.ib,f=u.edit;if(l===e.length){a.push({distance:c,i:s,edit:f});continue}if(t[s]===e[l])i.push({distance:c,ia:s+1,ib:l+1,edit:p});else{if(c>=n)continue;if(f!==v)i.push({distance:c+1,ia:s,ib:l+1,edit:m});if(s<t.length){if(f!==m)i.push({distance:c+1,ia:s+1,ib:l,edit:v});if(f!==m&&f!==v)i.push({distance:c+1,ia:s+1,ib:l+1,edit:g})}}}return a}(c,r,s-i,n,u,d).forEach(function(t){var e=t.distance,n=t.i,t=t.edit;l.push({node:o[r],distance:i+e,key:a+r,i:n,edit:t})})})};0<l.length;)e();return f}var r=function(t){return t[t.length-1]},p=0,g=1,v=2,m=3,f=(d.prototype.atPrefix=function(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");var e=h(u(this._tree,t.slice(this._prefix.length)),2),n=e[0],r=e[1];if(void 0===n){var o=h(k(r),2),e=o[0],i=o[1],r=Object.keys(e).find(function(t){return""!==t&&t.startsWith(i)});if(void 0!==r)return new d(((o={})[r.slice(i.length)]=e[r],o),t)}return new d(n||{},t)},d.prototype.clear=function(){delete this._size,this._tree={}},d.prototype.delete=function(t){return delete this._size,b(this._tree,t)},d.prototype.entries=function(){return new t(this,"ENTRIES")},d.prototype.forEach=function(t){var e,n;try{for(var r=s(this),o=r.next();!o.done;o=r.next()){var i=h(o.value,2);t(i[0],i[1],this)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},d.prototype.fuzzyGet=function(t,e){return n(this._tree,t,e)},d.prototype.get=function(t){t=i(this._tree,t);return void 0!==t?t[""]:void 0},d.prototype.has=function(t){t=i(this._tree,t);return void 0!==t&&t.hasOwnProperty("")},d.prototype.keys=function(){return new t(this,"KEYS")},d.prototype.set=function(t,e){if("string"!=typeof t)throw new Error("key must be a string");return delete this._size,c(this._tree,t)[""]=e,this},Object.defineProperty(d.prototype,"size",{get:function(){var t=this;return this._size||(this._size=0,this.forEach(function(){t._size+=1}),this._size)},enumerable:!1,configurable:!0}),d.prototype.update=function(t,e){if("string"!=typeof t)throw new Error("key must be a string");delete this._size;t=c(this._tree,t);return t[""]=e(t[""]),this},d.prototype.values=function(){return new t(this,"VALUES")},d.prototype[Symbol.iterator]=function(){return this.entries()},d.from=function(t){var e,n,r=new d;try{for(var o=s(t),i=o.next();!i.done;i=o.next()){var a=h(i.value,2),u=a[0],c=a[1];r.set(u,c)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},d.fromObject=function(t){return d.from(Object.entries(t))},d);function d(t,e){void 0===e&&(e=""),this._tree=t=void 0===t?{}:t,this._prefix=e}var o,u=function(t,e,n){if(void 0===n&&(n=[]),0===e.length||null==t)return[t,n];var r=Object.keys(t).find(function(t){return""!==t&&e.startsWith(t)});return void 0===r?(n.push([t,e]),u(void 0,"",n)):(n.push([t,r]),u(t[r],e.slice(r.length),n))},i=function(t,e){if(0===e.length||null==t)return t;var n=Object.keys(t).find(function(t){return""!==t&&e.startsWith(t)});return void 0!==n?i(t[n],e.slice(n.length)):void 0},c=function(t,e){if(0===e.length||null==t)return t;var n=Object.keys(t).find(function(t){return""!==t&&e.startsWith(t)});if(void 0!==n)return c(t[n],e.slice(n.length));var r=Object.keys(t).find(function(t){return""!==t&&t.startsWith(e[0])});if(void 0===r)return t[e]={},t[e];var o=y(e,r);return t[o]=((n={})[r.slice(o.length)]=t[r],n),delete t[r],c(t[o],e.slice(o.length))},y=function(t,e,n,r,o){return void 0===n&&(n=0),void 0===o&&(o=""),(r=void 0===r?Math.min(t.length,e.length):r)<=n||t[n]!==e[n]?o:y(t,e,n+1,r,o+t[n])},b=function(t,e){var n=h(u(t,e),2),t=n[0],e=n[1];void 0!==t&&(delete t[""],0===(n=Object.keys(t)).length&&w(e),1===n.length&&x(e,n[0],t[n[0]]))},w=function(t){var e,n;0!==t.length&&(delete(e=(n=h(k(t),2))[0])[n[1]],0===(n=Object.keys(e)).length&&w(t.slice(0,-1)),1===n.length&&""!==n[0]&&x(t.slice(0,-1),n[0],e[n[0]]))},x=function(t,e,n){var r;0!==t.length&&((t=(r=h(k(t),2))[0])[(r=r[1])+e]=n,delete t[r])},k=function(t){return t[t.length-1]},_=(S.prototype.add=function(n){var r=this,t=this._options,o=t.extractField,i=t.tokenize,a=t.processTerm,e=t.fields,u=t.idField,t=o(n,u);if(null==t)throw new Error('MiniSearch: document does not have ID field "'.concat(u,'"'));var c=this.addDocumentId(t);this.saveStoredFields(c,n),e.forEach(function(e){var t=o(n,e);null!=t&&(t=i(t.toString(),e),r.addFieldLength(c,r._fieldIds[e],r.documentCount-1,t.length),t.forEach(function(t){t=a(t,e);t&&r.addTerm(r._fieldIds[e],c,t)}))})},S.prototype.addAll=function(t){var e=this;t.forEach(function(t){return e.add(t)})},S.prototype.addAllAsync=function(t,e){var o=this,e=(e=void 0===e?{}:e).chunkSize,i=void 0===e?10:e,e={chunk:[],promise:Promise.resolve()},e=t.reduce(function(t,e,n){var r=t.chunk,t=t.promise;return r.push(e),(n+1)%i==0?{chunk:[],promise:t.then(function(){return new Promise(function(t){return setTimeout(t,0)})}).then(function(){return o.addAll(r)})}:{chunk:r,promise:t}},e),n=e.chunk;return e.promise.then(function(){return o.addAll(n)})},S.prototype.remove=function(n){var r=this,t=this._options,o=t.tokenize,i=t.processTerm,a=t.extractField,e=t.fields,t=t.idField,u=a(n,t);if(null==u)throw new Error('MiniSearch: document does not have ID field "'.concat(t,'"'));var c=h(Object.entries(this._documentIds).find(function(t){t=h(t,2);t[0];t=t[1];return u===t})||[],1)[0];if(null==c)throw new Error("MiniSearch: cannot remove document with ID ".concat(u,": it is not in the index"));e.forEach(function(e){var t=a(n,e);null!=t&&((t=o(t.toString(),e)).forEach(function(t){t=i(t,e);t&&r.removeTerm(r._fieldIds[e],c,t)}),r.removeFieldLength(c,r._fieldIds[e],r.documentCount,t.length))}),delete this._storedFields[c],delete this._documentIds[c],delete this._fieldLength[c],--this._documentCount},S.prototype.removeAll=function(t){var e=this;if(t)t.forEach(function(t){return e.remove(t)});else{if(0<arguments.length)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new f,this._documentCount=0,this._documentIds={},this._fieldLength={},this._averageFieldLength={},this._storedFields={},this._nextId=0}},S.prototype.search=function(t,i){var a=this;void 0===i&&(i={});t=this.executeQuery(t,i);return Object.entries(t).reduce(function(t,e){var n=h(e,2),r=n[0],o=n[1],e=o.score,n=o.match,o=o.terms,n={id:a._documentIds[r],terms:$(o),score:e,match:n};return Object.assign(n,a._storedFields[r]),null!=i.filter&&!i.filter(n)||t.push(n),t},[]).sort(function(t,e){return t.score<e.score?1:-1})},S.prototype.autoSuggest=function(t,e){void 0===e&&(e={}),e=l(l({},T),e);e=this.search(t,e).reduce(function(t,e){var n=e.score,r=e.terms,e=r.join(" ");return null==t[e]?t[e]={score:n,terms:r,count:1}:(t[e].score+=n,t[e].count+=1),t},{});return Object.entries(e).map(function(t){var e=h(t,2),n=e[0],t=e[1],e=t.score;return{suggestion:n,terms:t.terms,score:e/t.count}}).sort(function(t,e){return t.score<e.score?1:-1})},Object.defineProperty(S.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),S.loadJSON=function(t,e){if(null==e)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return S.loadJS(JSON.parse(t),e)},S.getDefault=function(t){if(C.hasOwnProperty(t))return I(C,t);throw new Error('MiniSearch: unknown option "'.concat(t,'"'))},S.loadJS=function(t,e){var n=t.index,r=t.documentCount,o=t.nextId,i=t.documentIds,a=t.fieldIds,u=t.fieldLength,c=t.averageFieldLength,t=t.storedFields,e=new S(e);return e._index=new f(n._tree,n._prefix),e._documentCount=r,e._nextId=o,e._documentIds=i,e._fieldIds=a,e._fieldLength=u,e._averageFieldLength=c,e._fieldIds=a,e._storedFields=t||{},e},S.prototype.executeQuery=function(n,r){var o=this;if(void 0===r&&(r={}),"string"==typeof n)return this.executeSearch(n,r);var t=n.queries.map(function(t){var e=l(l(l({},r),n),{queries:void 0});return o.executeQuery(t,e)});return this.combineResults(t,n.combineWith)},S.prototype.executeSearch=function(t,e){var n=this;void 0===e&&(e={});var r=this._options,o=r.tokenize,i=r.processTerm,r=r.searchOptions,a=l(l({tokenize:o,processTerm:i},r),e),e=a.tokenize,u=a.processTerm,t=e(t).map(function(t){return u(t)}).filter(function(t){return!!t}).map(A(a)).map(function(t){return n.executeQuerySpec(t,a)});return this.combineResults(t,a.combineWith)},S.prototype.executeQuerySpec=function(r,t){var o=this,t=l(l({},this._options.searchOptions),t),i=(t.fields||this._options.fields).reduce(function(t,e){var n;return l(l({},t),((n={})[e]=I(t,e)||1,n))},t.boost||{}),a=t.boostDocument,t=t.weights,t=l(l({},O.weights),t),u=t.fuzzy,c=t.prefix,t=this.termResults(r.term,i,a,this._index.get(r.term));if(!r.fuzzy&&!r.prefix)return t;var s=[t];return r.prefix&&this._index.atPrefix(r.term).forEach(function(t,e){var n=.3*(t.length-r.term.length)/t.length;s.push(o.termResults(t,i,a,e,c,n))}),r.fuzzy&&(t=(t=!0===r.fuzzy?.2:r.fuzzy)<1?Math.round(r.term.length*t):t,Object.entries(this._index.fuzzyGet(r.term,t)).forEach(function(t){var e=h(t,2),n=e[0],t=h(e[1],2),e=t[0],t=t[1]/n.length;s.push(o.termResults(n,i,a,e,u,t))})),s.reduce(j.or)},S.prototype.combineResults=function(t,e){if(0===t.length)return{};e=(e=void 0===e?"or":e).toLowerCase();return t.reduce(j[e])||{}},S.prototype.toJSON=function(){return{index:this._index,documentCount:this._documentCount,nextId:this._nextId,documentIds:this._documentIds,fieldIds:this._fieldIds,fieldLength:this._fieldLength,averageFieldLength:this._averageFieldLength,storedFields:this._storedFields}},S.prototype.termResults=function(s,t,l,e,n,f){var d=this;return void 0===f&&(f=0),null==e?{}:Object.entries(t).reduce(function(o,t){var t=h(t,2),i=t[0],a=t[1],u=d._fieldIds[i],t=e[u]||{ds:{}},c=t.df,t=t.ds;return Object.entries(t).forEach(function(t){var e=h(t,2),n=e[0],r=e[1],t=l?l(d._documentIds[n],s):1;t&&(e=d._fieldLength[n][u]/d._averageFieldLength[u],o[n]=o[n]||{score:0,match:{},terms:[]},o[n].terms.push(s),o[n].match[s]=I(o[n].match,s)||[],o[n].score+=t*E(r,c,d._documentCount,e,a,f),o[n].match[s].push(i))}),o},{})},S.prototype.addTerm=function(n,r,t){this._index.update(t,function(t){var e=(t=t||{})[n]||{df:0,ds:{}};return null==e.ds[r]&&(e.df+=1),e.ds[r]=(e.ds[r]||0)+1,l(l({},t),((t={})[n]=e,t))})},S.prototype.removeTerm=function(n,r,o){var i=this;this._index.has(o)?(this._index.update(o,function(t){var e=t[n];if(null==e||null==e.ds[r])return i.warnDocumentChanged(r,n,o),t;if(e.ds[r]<=1){if(e.df<=1)return delete t[n],t;--e.df}return e.ds[r]<=1?(delete e.ds[r],t):(--e.ds[r],l(l({},t),((t={})[n]=e,t)))}),0===Object.keys(this._index.get(o)).length&&this._index.delete(o)):this.warnDocumentChanged(r,n,o)},S.prototype.warnDocumentChanged=function(t,e,n){var r;null!=console&&null!=console.warn&&(r=Object.entries(this._fieldIds).find(function(t){t=h(t,2);return t[0],t[1]===e})[0],console.warn("MiniSearch: document with ID ".concat(this._documentIds[t],' has changed before removal: term "').concat(n,'" was not present in field "').concat(r,'". Removing a document after it has changed can corrupt the index!')))},S.prototype.addDocumentId=function(t){var e=this._nextId.toString(36);return this._documentIds[e]=t,this._documentCount+=1,this._nextId+=1,e},S.prototype.addFields=function(t){var n=this;t.forEach(function(t,e){n._fieldIds[t]=e})},S.prototype.addFieldLength=function(t,e,n,r){this._averageFieldLength[e]=this._averageFieldLength[e]||0;var o=this._averageFieldLength[e]*n+r;this._fieldLength[t]=this._fieldLength[t]||{},this._fieldLength[t][e]=r,this._averageFieldLength[e]=o/(n+1)},S.prototype.removeFieldLength=function(t,e,n,r){r=this._averageFieldLength[e]*n-r;this._averageFieldLength[e]=r/(n-1)},S.prototype.saveStoredFields=function(n,r){var o=this,t=this._options,e=t.storeFields,i=t.extractField;null!=e&&0!==e.length&&(this._storedFields[n]=this._storedFields[n]||{},e.forEach(function(t){var e=i(r,t);void 0!==e&&(o._storedFields[n][t]=e)}))},S);function S(t){if(null==(null==t?void 0:t.fields))throw new Error('MiniSearch: option "fields" must be provided');this._options=l(l(l({},C),t),{searchOptions:l(l({},O),t.searchOptions||{})}),this._index=new f,this._documentCount=0,this._documentIds={},this._fieldIds={},this._fieldLength={},this._averageFieldLength={},this._nextId=0,this._storedFields={},this.addFields(this._options.fields)}var I=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},j=((o={}).or=function(t,e){return Object.entries(e).reduce(function(t,e){var n=h(e,2),r=n[0],o=n[1],e=o.score,n=o.match,o=o.terms;return null==t[r]?t[r]={score:e,match:n,terms:o}:(t[r].score+=e,t[r].score*=1.5,(e=t[r].terms).push.apply(e,a([],h(o),!1)),Object.assign(t[r].match,n)),t},t||{})},o.and=function(i,t){return Object.entries(t).reduce(function(t,e){var n=h(e,2),r=n[0],o=n[1],e=o.score,n=o.match,o=o.terms;return void 0===i[r]||(t[r]=t[r]||{},t[r].score=i[r].score+e,t[r].match=l(l({},i[r].match),n),t[r].terms=a(a([],h(i[r].terms),!1),h(o),!1)),t},{})},o.and_not=function(t,e){return Object.entries(e).reduce(function(t,e){var n=h(e,2),e=n[0],n=n[1];return n.score,n.match,n.terms,delete t[e],t},t||{})},o),E=function(t,e,n,r,o,i){return o/(1+.333*o*i)*(t*Math.log(n/e))/r},A=function(r){return function(t,e,n){return{term:t,fuzzy:"function"==typeof r.fuzzy?r.fuzzy(t,e,n):r.fuzzy||!1,prefix:"function"==typeof r.prefix?r.prefix(t,e,n):!0===r.prefix}}},$=function(t){return t.filter(function(t,e,n){return n.indexOf(t)===e})},C={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(F)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},O={combineWith:"or",prefix:!1,fuzzy:!1,boost:{},weights:{fuzzy:.9,prefix:.75}},T={prefix:function(t,e,n){return e===n.length-1}},F=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;return _},"object"==typeof n&&void 0!==e?e.exports=o():"function"==typeof define&&define.amd?define(o):(r="undefined"!=typeof globalThis?globalThis:r||self).MiniSearch=o()},{}],50:[function(t,e,n){var r,o,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&h())}function h(){if(!l){var t=u(d);l=!0;for(var e=s.length;e;){for(c=s,s=[];++f<e;)c&&c[f].run();f=-1,e=s.length}c=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new p(t,e)),1!==s.length||l||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=g,e.addListener=g,e.once=g,e.off=g,e.removeListener=g,e.removeAllListeners=g,e.emit=g,e.prependListener=g,e.prependOnceListener=g,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],51:[function(t,A,$){!function(E){!function(){!function(t){var e="object"==typeof $&&$&&!$.nodeType&&$,n="object"==typeof A&&A&&!A.nodeType&&A,r="object"==typeof E&&E;r.global!==r&&r.window!==r&&r.self!==r||(t=r);var o,i,v=2147483647,m=36,y=26,a=38,u=700,c=/^xn--/,s=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=m-1,b=Math.floor,w=String.fromCharCode;function x(t){throw new RangeError(f[t])}function h(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function p(t,e){var n=t.split("@"),r="";return 1<n.length&&(r=n[0]+"@",t=n[1]),r+h((t=t.replace(l,".")).split("."),e).join(".")}function k(t){for(var e,n,r=[],o=0,i=t.length;o<i;)55296<=(e=t.charCodeAt(o++))&&e<=56319&&o<i?56320==(64512&(n=t.charCodeAt(o++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--):r.push(e);return r}function g(t){return h(t,function(t){var e="";return 65535<t&&(e+=w((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=w(t)}).join("")}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function S(t,e,n){var r=0;for(t=n?b(t/u):t>>1,t+=b(t/e);d*y>>1<t;r+=m)t=b(t/d);return b(r+(d+1)*t/(t+a))}function I(t){var e,n,r,o,i,a,u,c=[],s=t.length,l=0,f=128,d=72,h=t.lastIndexOf("-");for(h<0&&(h=0),n=0;n<h;++n)128<=t.charCodeAt(n)&&x("not-basic"),c.push(t.charCodeAt(n));for(r=0<h?h+1:0;r<s;){for(o=l,i=1,a=m;s<=r&&x("invalid-input"),u=t.charCodeAt(r++),(m<=(u=u-48<10?u-22:u-65<26?u-65:u-97<26?u-97:m)||u>b((v-l)/i))&&x("overflow"),l+=u*i,!(u<(u=a<=d?1:d+y<=a?y:a-d));a+=m)i>b(v/(u=m-u))&&x("overflow"),i*=u;d=S(l-o,e=c.length+1,0==o),b(l/e)>v-f&&x("overflow"),f+=b(l/e),l%=e,c.splice(l++,0,f)}return g(c)}function j(t){for(var e,n,r,o,i,a,u,c,s,l,f=[],d=(t=k(t)).length,h=128,p=72,g=e=0;g<d;++g)(u=t[g])<128&&f.push(w(u));for(n=r=f.length,r&&f.push("-");n<d;){for(o=v,g=0;g<d;++g)h<=(u=t[g])&&u<o&&(o=u);for(o-h>b((v-e)/(c=n+1))&&x("overflow"),e+=(o-h)*c,h=o,g=0;g<d;++g)if((u=t[g])<h&&++e>v&&x("overflow"),u==h){for(i=e,a=m;!(i<(s=a<=p?1:p+y<=a?y:a-p));a+=m)f.push(w(_(s+(l=i-s)%(s=m-s),0))),i=b(l/s);f.push(w(_(i,0))),p=S(e,c,n==r),e=0,++n}++e,++h}return f.join("")}if(o={version:"1.4.1",ucs2:{decode:k,encode:g},decode:I,encode:j,toASCII:function(t){return p(t,function(t){return s.test(t)?"xn--"+j(t):t})},toUnicode:function(t){return p(t,function(t){return c.test(t)?I(t.slice(4).toLowerCase()):t})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return o});else if(e&&n)if(A.exports==e)n.exports=o;else for(i in o)o.hasOwnProperty(i)&&(e[i]=o[i]);else t.punycode=o}(this)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var i=/\+/g;t=t.split(e=e||"&");e=1e3;r&&"number"==typeof r.maxKeys&&(e=r.maxKeys);var a=t.length;0<e&&e<a&&(a=e);for(var u=0;u<a;++u){var c,s=t[u].replace(i,"%20"),l=s.indexOf(n),l=0<=l?(c=s.substr(0,l),s.substr(l+1)):(c=s,""),s=decodeURIComponent(c),l=decodeURIComponent(l);Object.prototype.hasOwnProperty.call(o,s)?f(o[s])?o[s].push(l):o[s]=[o[s],l]:o[s]=l}return o};var f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],53:[function(t,e,n){"use strict";function i(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}e.exports=function(n,r,o,t){return r=r||"&",o=o||"=","object"==typeof(n=null===n?void 0:n)?u(c(n),function(t){var e=encodeURIComponent(i(t))+o;return a(n[t])?u(n[t],function(t){return e+encodeURIComponent(i(t))}).join(r):e+encodeURIComponent(i(n[t]))}).join(r):t?encodeURIComponent(i(t))+o+encodeURIComponent(i(n)):""};var a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function u(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var c=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}},{}],54:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":52,"./encode":53}],55:[function(c,t,s){!function(n,u){!function(){var r=c("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function e(t,e){this._id=t,this._clearFn=e}s.setTimeout=function(){return new e(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new e(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(t){var e=a++,n=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,r(function(){i[e]&&(n?t.apply(null,n):t.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof u?u:function(t){delete i[t]}}.call(this)}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":50,timers:55}],56:[function(t,o,i){!function(De){!function(){var t,e,n,r;t=this,e=function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof De&&De.global===De&&De||Function("return this")()||{},r=Array.prototype,a=Object.prototype,f="undefined"!=typeof Symbol?Symbol.prototype:null,o=r.push,c=r.slice,d=a.toString,n=a.hasOwnProperty,e="undefined"!=typeof ArrayBuffer,i="undefined"!=typeof DataView,u=Array.isArray,s=Object.keys,l=Object.create,h=e&&ArrayBuffer.isView,p=isNaN,g=isFinite,v=!{toString:null}.propertyIsEnumerable("toString"),m=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],y=Math.pow(2,53)-1;function b(o,i){return i=null==i?o.length-1:+i,function(){for(var t=Math.max(arguments.length-i,0),e=Array(t),n=0;n<t;n++)e[n]=arguments[n+i];switch(i){case 0:return o.call(this,e);case 1:return o.call(this,arguments[0],e);case 2:return o.call(this,arguments[0],arguments[1],e)}for(var r=Array(i+1),n=0;n<i;n++)r[n]=arguments[n];return r[i]=e,o.apply(this,r)}}function w(t){var e=typeof t;return"function"==e||"object"==e&&!!t}function x(t){return void 0===t}function k(t){return!0===t||!1===t||"[object Boolean]"===d.call(t)}function _(t){var e="[object "+t+"]";return function(t){return d.call(t)===e}}var S=_("String"),I=_("Number"),j=_("Date"),E=_("RegExp"),A=_("Error"),$=_("Symbol"),C=_("ArrayBuffer"),O=_("Function"),T=t.document&&t.document.childNodes,F=O="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof T?function(t){return"function"==typeof t||!1}:O,L=_("Object"),R=i&&L(new DataView(new ArrayBuffer(8))),D="undefined"!=typeof Map&&L(new Map),P=_("DataView");var N=R?function(t){return null!=t&&F(t.getInt8)&&C(t.buffer)}:P,M=u||_("Array");function B(t,e){return null!=t&&n.call(t,e)}var z=_("Arguments");!function(){z(arguments)||(z=function(t){return B(t,"callee")})}();var U=z;function q(t){return I(t)&&p(t)}function K(t){return function(){return t}}function W(e){return function(t){t=e(t);return"number"==typeof t&&0<=t&&t<=y}}function H(e){return function(t){return null==t?void 0:t[e]}}var J=H("byteLength"),G=W(J),V=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Y=e?function(t){return h?h(t)&&!N(t):G(t)&&V.test(d.call(t))}:K(!1),Q=H("length");function X(t,e){e=function(e){for(var n={},t=e.length,r=0;r<t;++r)n[e[r]]=!0;return{contains:function(t){return!0===n[t]},push:function(t){return n[t]=!0,e.push(t)}}}(e);var n=m.length,r=t.constructor,o=F(r)&&r.prototype||a,i="constructor";for(B(t,i)&&!e.contains(i)&&e.push(i);n--;)(i=m[n])in t&&t[i]!==o[i]&&!e.contains(i)&&e.push(i)}function Z(t){if(!w(t))return[];if(s)return s(t);var e,n=[];for(e in t)B(t,e)&&n.push(e);return v&&X(t,n),n}function tt(t,e){var n=Z(e),r=n.length;if(null==t)return!r;for(var o=Object(t),i=0;i<r;i++){var a=n[i];if(e[a]!==o[a]||!(a in o))return!1}return!0}function et(t){return t instanceof et?t:this instanceof et?void(this._wrapped=t):new et(t)}function nt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,J(t))}et.VERSION="1.13.2",et.prototype.valueOf=et.prototype.toJSON=et.prototype.value=function(){return this._wrapped},et.prototype.toString=function(){return String(this._wrapped)};var rt="[object DataView]";function ot(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"==o||"object"==o||"object"==typeof e)&&function t(e,n,r,o){e instanceof et&&(e=e._wrapped);n instanceof et&&(n=n._wrapped);var i=d.call(e);if(i!==d.call(n))return!1;if(R&&"[object Object]"==i&&N(e)){if(!N(n))return!1;i=rt}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return f.valueOf.call(e)===f.valueOf.call(n);case"[object ArrayBuffer]":case rt:return t(nt(e),nt(n),r,o)}var a="[object Array]"===i;if(!a&&Y(e)){var u=J(e);if(u!==J(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof e||"object"!=typeof n)return!1;i=e.constructor,u=n.constructor;if(i!==u&&!(F(i)&&i instanceof i&&F(u)&&u instanceof u)&&"constructor"in e&&"constructor"in n)return!1}r=r||[];o=o||[];var c=r.length;for(;c--;)if(r[c]===e)return o[c]===n;r.push(e);o.push(n);if(a){if((c=e.length)!==n.length)return!1;for(;c--;)if(!ot(e[c],n[c],r,o))return!1}else{var s,l=Z(e);if(c=l.length,Z(n).length!==c)return!1;for(;c--;)if(s=l[c],!B(n,s)||!ot(e[s],n[s],r,o))return!1}r.pop();o.pop();return!0}(t,e,n,r)}function it(t){if(!w(t))return[];var e,n=[];for(e in t)n.push(e);return v&&X(t,n),n}function at(r){var o=Q(r);return function(t){if(null==t)return!1;var e=it(t);if(Q(e))return!1;for(var n=0;n<o;n++)if(!F(t[r[n]]))return!1;return r!==ft||!F(t[ut])}}var ut="forEach",ct=["clear","delete"],st=["get","has","set"],lt=ct.concat(ut,st),ft=ct.concat(st),dt=["add"].concat(ct,ut,"has"),ht=D?at(lt):_("Map"),pt=D?at(ft):_("WeakMap"),gt=D?at(dt):_("Set"),vt=_("WeakSet");function mt(t){for(var e=Z(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r}function yt(t){for(var e={},n=Z(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e}function bt(t){var e,n=[];for(e in t)F(t[e])&&n.push(e);return n.sort()}function wt(c,s){return function(t){var e=arguments.length;if(s&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var r=arguments[n],o=c(r),i=o.length,a=0;a<i;a++){var u=o[a];s&&void 0!==t[u]||(t[u]=r[u])}return t}}var xt=wt(it),kt=wt(Z),_t=wt(it,!0);function St(t){if(!w(t))return{};if(l)return l(t);var e=function(){};e.prototype=t;t=new e;return e.prototype=null,t}function It(t){return M(t)?t:[t]}function jt(t){return et.toPath(t)}function Et(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function At(t,e,n){e=Et(t,jt(e));return x(e)?n:e}function $t(t){return t}function Ct(e){return e=kt({},e),function(t){return tt(t,e)}}function Ot(e){return e=jt(e),function(t){return Et(t,e)}}function Tt(o,i,t){if(void 0===i)return o;switch(null==t?3:t){case 1:return function(t){return o.call(i,t)};case 3:return function(t,e,n){return o.call(i,t,e,n)};case 4:return function(t,e,n,r){return o.call(i,t,e,n,r)}}return function(){return o.apply(i,arguments)}}function Ft(t,e,n){return null==t?$t:F(t)?Tt(t,e,n):(w(t)&&!M(t)?Ct:Ot)(t)}function Lt(t,e){return Ft(t,e,1/0)}function Rt(t,e,n){return et.iteratee!==Lt?et.iteratee(t,e):Ft(t,e,n)}function Dt(){}function Pt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}et.toPath=It,et.iteratee=Lt;var Nt=Date.now||function(){return(new Date).getTime()};function Mt(e){function n(t){return e[t]}var t="(?:"+Z(e).join("|")+")",r=RegExp(t),o=RegExp(t,"g");return function(t){return r.test(t=null==t?"":""+t)?t.replace(o,n):t}}var Bt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},zt=Mt(Bt),Ut=Mt(yt(Bt)),qt=et.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Kt=/(.)^/,Wt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ht=/\\|'|\r|\n|\u2028|\u2029/g;function Jt(t){return"\\"+Wt[t]}var Gt=/^\s*(\w|\$)+\s*$/;var Vt=0;function Yt(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);n=St(t.prototype),o=t.apply(n,o);return w(o)?o:n}var Qt=b(function(o,i){function a(){for(var t=0,e=i.length,n=Array(e),r=0;r<e;r++)n[r]=i[r]===u?arguments[t++]:i[r];for(;t<arguments.length;)n.push(arguments[t++]);return Yt(o,a,this,this,n)}var u=Qt.placeholder;return a});Qt.placeholder=et;var Xt=b(function(e,n,r){if(!F(e))throw new TypeError("Bind must be called on a function");var o=b(function(t){return Yt(e,o,n,this,r.concat(t))});return o}),Zt=W(Q);function te(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var o=r.length,i=0,a=Q(t);i<a;i++){var u=t[i];if(Zt(u)&&(M(u)||U(u)))if(1<e)te(u,e-1,n,r),o=r.length;else for(var c=0,s=u.length;c<s;)r[o++]=u[c++];else n||(r[o++]=u)}return r}var ee=b(function(t,e){var n=(e=te(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Xt(t[r],t)}return t});var ne=b(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),re=Qt(ne,et,1);function oe(t){return function(){return!t.apply(this,arguments)}}function ie(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}t=Qt(ie,2);function ae(t,e,n){e=Rt(e,n);for(var r,o=Z(t),i=0,a=o.length;i<a;i++)if(e(t[r=o[i]],r,t))return r}function ue(i){return function(t,e,n){e=Rt(e,n);for(var r=Q(t),o=0<i?0:r-1;0<=o&&o<r;o+=i)if(e(t[o],o,t))return o;return-1}}var ce=ue(1),T=ue(-1);function se(t,e,n,r){for(var o=(n=Rt(n,r,1))(e),i=0,a=Q(t);i<a;){var u=Math.floor((i+a)/2);n(t[u])<o?i=u+1:a=u}return i}function le(i,a,u){return function(t,e,n){var r=0,o=Q(t);if("number"==typeof n)0<i?r=0<=n?n:Math.max(n+o,r):o=0<=n?Math.min(n+1,o):n+o+1;else if(u&&n&&o)return t[n=u(t,e)]===e?n:-1;if(e!=e)return 0<=(n=a(c.call(t,r,o),q))?n+r:-1;for(n=0<i?r:o-1;0<=n&&n<o;n+=i)if(t[n]===e)return n;return-1}}var fe=le(1,ce,se),O=le(-1,T);function de(t,e,n){n=(Zt(t)?ce:ae)(t,e,n);if(void 0!==n&&-1!==n)return t[n]}function he(t,e,n){if(e=Tt(e,n),Zt(t))for(o=0,i=t.length;o<i;o++)e(t[o],o,t);else for(var r=Z(t),o=0,i=r.length;o<i;o++)e(t[r[o]],r[o],t);return t}function pe(t,e,n){e=Rt(e,n);for(var r=!Zt(t)&&Z(t),o=(r||t).length,i=Array(o),a=0;a<o;a++){var u=r?r[a]:a;i[a]=e(t[u],u,t)}return i}function ge(c){return function(t,e,n,r){var o=3<=arguments.length;return function(t,e,n,r){var o=!Zt(t)&&Z(t),i=(o||t).length,a=0<c?0:i-1;for(r||(n=t[o?o[a]:a],a+=c);0<=a&&a<i;a+=c){var u=o?o[a]:a;n=e(n,t[u],u,t)}return n}(t,Tt(e,r,4),n,o)}}i=ge(1),L=ge(-1);function ve(t,r,e){var o=[];return r=Rt(r,e),he(t,function(t,e,n){r(t,e,n)&&o.push(t)}),o}function me(t,e,n){e=Rt(e,n);for(var r=!Zt(t)&&Z(t),o=(r||t).length,i=0;i<o;i++){var a=r?r[i]:i;if(!e(t[a],a,t))return!1}return!0}function ye(t,e,n){e=Rt(e,n);for(var r=!Zt(t)&&Z(t),o=(r||t).length,i=0;i<o;i++){var a=r?r[i]:i;if(e(t[a],a,t))return!0}return!1}function be(t,e,n,r){return Zt(t)||(t=mt(t)),0<=fe(t,e,n="number"!=typeof n||r?0:n)}P=b(function(t,n,r){var o,i;return F(n)?i=n:(n=jt(n),o=n.slice(0,-1),n=n[n.length-1]),pe(t,function(t){var e=i;if(!e){if(null==(t=o&&o.length?Et(t,o):t))return;e=t[n]}return null==e?e:e.apply(t,r)})});function we(t,e){return pe(t,Ot(e))}function xe(t,r,e){var n,o,i=-1/0,a=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var u=0,c=(t=Zt(t)?t:mt(t)).length;u<c;u++)null!=(n=t[u])&&i<n&&(i=n);else r=Rt(r,e),he(t,function(t,e,n){o=r(t,e,n),(a<o||o===-1/0&&i===-1/0)&&(i=t,a=o)});return i}var ke=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function _e(t){return t?M(t)?c.call(t):S(t)?t.match(ke):Zt(t)?pe(t,$t):mt(t):[]}function Se(t,e,n){if(null==e||n)return(t=!Zt(t)?mt(t):t)[Pt(t.length-1)];var r=_e(t),t=Q(r);e=Math.max(Math.min(e,t),0);for(var o=t-1,i=0;i<e;i++){var a=Pt(i,o),u=r[i];r[i]=r[a],r[a]=u}return r.slice(0,e)}function Ie(i,e){return function(n,r,t){var o=e?[[],[]]:{};return r=Rt(r,t),he(n,function(t,e){e=r(t,e,n);i(o,t,e)}),o}}u=Ie(function(t,e,n){B(t,n)?t[n].push(e):t[n]=[e]}),e=Ie(function(t,e,n){t[n]=e}),st=Ie(function(t,e,n){B(t,n)?t[n]++:t[n]=1}),ct=Ie(function(t,e,n){t[n?0:1].push(e)},!0);function je(t,e,n){return e in n}var Ee=b(function(t,e){var n={},r=e[0];if(null==t)return n;F(r)?(1<e.length&&(r=Tt(r,e[1])),e=it(t)):(r=je,e=te(e,!1,!1),t=Object(t));for(var o=0,i=e.length;o<i;o++){var a=e[o],u=t[a];r(u,a,t)&&(n[a]=u)}return n}),lt=b(function(t,n){var e,r=n[0];return F(r)?(r=oe(r),1<n.length&&(e=n[1])):(n=pe(te(n,!1,!1),String),r=function(t,e){return!be(n,e)}),Ee(t,r,e)});function Ae(t,e,n){return c.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function $e(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Ae(t,t.length-e)}function Ce(t,e,n){return c.call(t,null==e||n?1:e)}var Oe=b(function(t,e){return e=te(e,!0,!0),ve(t,function(t){return!be(e,t)})}),D=b(function(t,e){return Oe(t,e)});function Te(t,e,n,r){k(e)||(r=n,n=e,e=!1),null!=n&&(n=Rt(n,r));for(var o=[],i=[],a=0,u=Q(t);a<u;a++){var c=t[a],s=n?n(c,a,t):c;e&&!n?(a&&i===s||o.push(c),i=s):n?be(i,s)||(i.push(s),o.push(c)):be(o,c)||o.push(c)}return o}dt=b(function(t){return Te(te(t,!0,!0))});function Fe(t){for(var e=t&&xe(t,Q).length||0,n=Array(e),r=0;r<e;r++)n[r]=we(t,r);return n}Bt=b(Fe);function Le(t,e){return t._chain?et(e).chain():e}function Re(n){return he(bt(n),function(t){var e=et[t]=n[t];et.prototype[t]=function(){var t=[this._wrapped];return o.apply(t,arguments),Le(this,e.apply(et,t))}}),et}he(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=r[e];et.prototype[e]=function(){var t=this._wrapped;return null!=t&&(n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0]),Le(this,t)}}),he(["concat","join","slice"],function(t){var e=r[t];et.prototype[t]=function(){var t=this._wrapped;return Le(this,t=null!=t?e.apply(t,arguments):t)}});Bt=Re({__proto__:null,VERSION:"1.13.2",restArguments:b,isObject:w,isNull:function(t){return null===t},isUndefined:x,isBoolean:k,isElement:function(t){return!(!t||1!==t.nodeType)},isString:S,isNumber:I,isDate:j,isRegExp:E,isError:A,isSymbol:$,isArrayBuffer:C,isDataView:N,isArray:M,isFunction:F,isArguments:U,isFinite:function(t){return!$(t)&&g(t)&&!isNaN(parseFloat(t))},isNaN:q,isTypedArray:Y,isEmpty:function(t){if(null==t)return!0;var e=Q(t);return"number"==typeof e&&(M(t)||S(t)||U(t))?0===e:0===Q(Z(t))},isMatch:tt,isEqual:function(t,e){return ot(t,e)},isMap:ht,isWeakMap:pt,isSet:gt,isWeakSet:vt,keys:Z,allKeys:it,values:mt,pairs:function(t){for(var e=Z(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},invert:yt,functions:bt,methods:bt,extend:xt,extendOwn:kt,assign:kt,defaults:_t,create:function(t,e){return t=St(t),e&&kt(t,e),t},clone:function(t){return w(t)?M(t)?t.slice():xt({},t):t},tap:function(t,e){return e(t),t},get:At,has:function(t,e){for(var n=(e=jt(e)).length,r=0;r<n;r++){var o=e[r];if(!B(t,o))return!1;t=t[o]}return!!n},mapObject:function(t,e,n){e=Rt(e,n);for(var r=Z(t),o=r.length,i={},a=0;a<o;a++){var u=r[a];i[u]=e(t[u],u,t)}return i},identity:$t,constant:K,noop:Dt,toPath:It,property:Ot,propertyOf:function(e){return null==e?Dt:function(t){return At(e,t)}},matcher:Ct,matches:Ct,times:function(t,e,n){var r=Array(Math.max(0,t));e=Tt(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},random:Pt,now:Nt,escape:zt,unescape:Ut,templateSettings:qt,template:function(i,t,e){t=_t({},t=!t&&e?e:t,et.templateSettings);var n,e=RegExp([(t.escape||Kt).source,(t.interpolate||Kt).source,(t.evaluate||Kt).source].join("|")+"|$","g"),a=0,u="__p+='";if(i.replace(e,function(t,e,n,r,o){return u+=i.slice(a,o).replace(Ht,Jt),a=o+t.length,e?u+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?u+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(u+="';\n"+r+"\n__p+='"),t}),u+="';\n",t=t.variable){if(!Gt.test(t))throw new Error("variable is not a bare identifier: "+t)}else u="with(obj||{}){\n"+u+"}\n",t="obj";u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{n=new Function(t,"_",u)}catch(t){throw t.source=u,t}function r(t){return n.call(this,t,et)}return r.source="function("+t+"){\n"+u+"}",r},result:function(t,e,n){var r=(e=jt(e)).length;if(!r)return F(n)?n.call(t):n;for(var o=0;o<r;o++){var i=null==t?void 0:t[e[o]];void 0===i&&(i=n,o=r),t=F(i)?i.call(t):i}return t},uniqueId:function(t){var e=++Vt+"";return t?t+e:e},chain:function(t){return(t=et(t))._chain=!0,t},iteratee:Lt,partial:Qt,bind:Xt,bindAll:ee,memoize:function(r,o){function i(t){var e=i.cache,n=""+(o?o.apply(this,arguments):t);return B(e,n)||(e[n]=r.apply(this,arguments)),e[n]}return i.cache={},i},delay:ne,defer:re,throttle:function(n,r,o){var i,a,u,c,s=0;function l(){s=!1===o.leading?0:Nt(),i=null,c=n.apply(a,u),i||(a=u=null)}function t(){var t=Nt();s||!1!==o.leading||(s=t);var e=r-(t-s);return a=this,u=arguments,e<=0||r<e?(i&&(clearTimeout(i),i=null),s=t,c=n.apply(a,u),i||(a=u=null)):i||!1===o.trailing||(i=setTimeout(l,e)),c}return o=o||{},t.cancel=function(){clearTimeout(i),s=0,i=a=u=null},t},debounce:function(e,n,r){function o(){var t=Nt()-a;t<n?i=setTimeout(o,n-t):(i=null,r||(c=e.apply(s,u)),i||(u=s=null))}var i,a,u,c,s,t=b(function(t){return s=this,u=t,a=Nt(),i||(i=setTimeout(o,n),r&&(c=e.apply(s,u))),c});return t.cancel=function(){clearTimeout(i),i=u=s=null},t},wrap:function(t,e){return Qt(e,t)},negate:oe,compose:function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:ie,once:t,findKey:ae,findIndex:ce,findLastIndex:T,sortedIndex:se,indexOf:fe,lastIndexOf:O,find:de,detect:de,findWhere:function(t,e){return de(t,Ct(e))},each:he,forEach:he,map:pe,collect:pe,reduce:i,foldl:i,inject:i,reduceRight:L,foldr:L,filter:ve,select:ve,reject:function(t,e,n){return ve(t,oe(Rt(e)),n)},every:me,all:me,some:ye,any:ye,contains:be,includes:be,include:be,invoke:P,pluck:we,where:function(t,e){return ve(t,Ct(e))},max:xe,min:function(t,r,e){var n,o,i=1/0,a=1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var u=0,c=(t=Zt(t)?t:mt(t)).length;u<c;u++)null!=(n=t[u])&&n<i&&(i=n);else r=Rt(r,e),he(t,function(t,e,n){((o=r(t,e,n))<a||o===1/0&&i===1/0)&&(i=t,a=o)});return i},shuffle:function(t){return Se(t,1/0)},sample:Se,sortBy:function(t,r,e){var o=0;return r=Rt(r,e),we(pe(t,function(t,e,n){return{value:t,index:o++,criteria:r(t,e,n)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")},groupBy:u,indexBy:e,countBy:st,partition:ct,toArray:_e,size:function(t){return null==t?0:(Zt(t)?t:Z(t)).length},pick:Ee,omit:lt,first:$e,head:$e,take:$e,initial:Ae,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:Ce(t,Math.max(0,t.length-e))},rest:Ce,tail:Ce,drop:Ce,compact:function(t){return ve(t,Boolean)},flatten:function(t,e){return te(t,e,!1)},without:D,uniq:Te,unique:Te,union:dt,intersection:function(t){for(var e=[],n=arguments.length,r=0,o=Q(t);r<o;r++){var i=t[r];if(!be(e,i)){for(var a=1;a<n&&be(arguments[a],i);a++);a===n&&e.push(i)}}return e},difference:Oe,unzip:Fe,transpose:Fe,zip:Bt,object:function(t,e){for(var n={},r=0,o=Q(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n=n||(e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),i=0;i<r;i++,t+=n)o[i]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(c.call(t,r,r+=e));return n},mixin:Re,default:et});return Bt._=Bt},"object"==typeof i&&void 0!==o?o.exports=e():"function"==typeof define&&define.amd?define("underscore",e):(t="undefined"!=typeof globalThis?globalThis:t||self,n=t._,(r=t._=e()).noConflict=function(){return t._=n,r})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],57:[function(t,e,n){"use strict";var j=t("punycode"),E=t("./util");function x(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=o,n.resolve=function(t,e){return o(t,!1,!0).resolve(e)},n.resolveObject=function(t,e){return t?o(t,!1,!0).resolveObject(e):e},n.format=function(t){E.isString(t)&&(t=o(t));return t instanceof x?t.format():x.prototype.format.call(t)},n.Url=x;var A=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,$=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),C=["'"].concat(n),O=["%","/","?",";","#"].concat(C),T=["/","?","#"],F=/^[+a-z0-9A-Z_-]{0,63}$/,L=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,R={javascript:!0,"javascript:":!0},D={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},N=t("querystring");function o(t,e,n){if(t&&E.isObject(t)&&t instanceof x)return t;var r=new x;return r.parse(t,e,n),r}x.prototype.parse=function(t,e,n){if(!E.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",r=t.split(o);r[0]=r[0].replace(/\\/g,"/");var i=(i=t=r.join(o)).trim();if(!n&&1===t.split("#").length){var a=$.exec(i);if(a)return this.path=i,this.href=i,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?N.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var u,a=A.exec(i);if(a&&(I=(a=a[0]).toLowerCase(),this.protocol=I,i=i.substr(a.length)),(n||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(u="//"===i.substr(0,2))||a&&D[a]||(i=i.substr(2),this.slashes=!0)),!D[a]&&(u||a&&!P[a])){for(var c=-1,s=0;s<T.length;s++)-1!==(l=i.indexOf(T[s]))&&(-1===c||l<c)&&(c=l);-1!==(x=-1===c?i.lastIndexOf("@"):i.lastIndexOf("@",c))&&(k=i.slice(0,x),i=i.slice(x+1),this.auth=decodeURIComponent(k));for(var l,c=-1,s=0;s<O.length;s++)-1!==(l=i.indexOf(O[s]))&&(-1===c||l<c)&&(c=l);-1===c&&(c=i.length),this.host=i.slice(0,c),i=i.slice(c),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var d=this.hostname.split(/\./),s=0,h=d.length;s<h;s++){var p=d[s];if(p&&!p.match(F)){for(var g="",v=0,m=p.length;v<m;v++)127<p.charCodeAt(v)?g+="x":g+=p[v];if(!g.match(F)){var y=d.slice(0,s),b=d.slice(s+1),w=p.match(L);w&&(y.push(w[1]),b.unshift(w[2])),b.length&&(i="/"+b.join(".")+i),this.hostname=y.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),f||(this.hostname=j.toASCII(this.hostname));var x=this.port?":"+this.port:"",k=this.hostname||"";this.host=k+x,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!R[I])for(s=0,h=C.length;s<h;s++){var _,S=C[s];-1!==i.indexOf(S)&&((_=encodeURIComponent(S))===S&&(_=escape(S)),i=i.split(S).join(_))}f=i.indexOf("#");-1!==f&&(this.hash=i.substr(f),i=i.slice(0,f));var I,f=i.indexOf("?");return-1!==f?(this.search=i.substr(f),this.query=i.substr(f+1),e&&(this.query=N.parse(this.query)),i=i.slice(0,f)):e&&(this.search="",this.query={}),i&&(this.pathname=i),P[I]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(x=this.pathname||"",I=this.search||"",this.path=x+I),this.href=this.format(),this},x.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&E.isObject(this.query)&&Object.keys(this.query).length&&(i=N.stringify(this.query));i=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||P[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o=o||"",r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),e+o+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(i=i.replace("#","%23"))+r},x.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},x.prototype.resolveObject=function(t){E.isString(t)&&((h=new x).parse(t,!1,!0),t=h);for(var e=new x,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];e[o]=this[o]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var i=Object.keys(t),a=0;a<i.length;a++){var u=i[a];"protocol"!==u&&(e[u]=t[u])}return P[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!P[t.protocol]){for(var c=Object.keys(t),s=0;s<c.length;s++){var l=c[s];e[l]=t[l]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||D[t.protocol])e.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),e.pathname=f.join("/")}return e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,(e.pathname||e.search)&&(p=e.pathname||"",g=e.search||"",e.path=p+g),e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var d=e.pathname&&"/"===e.pathname.charAt(0),h=t.host||t.pathname&&"/"===t.pathname.charAt(0),p=h||d||e.host&&t.pathname,g=p,v=e.pathname&&e.pathname.split("/")||[],f=t.pathname&&t.pathname.split("/")||[],d=e.protocol&&!P[e.protocol];if(d&&(e.hostname="",e.port=null,e.host&&(""===v[0]?v[0]=e.host:v.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),p=p&&(""===f[0]||""===v[0])),h)e.host=(t.host||""===t.host?t:e).host,e.hostname=(t.hostname||""===t.hostname?t:e).hostname,e.search=t.search,e.query=t.query,v=f;else if(f.length)(v=v||[]).pop(),v=v.concat(f),e.search=t.search,e.query=t.query;else if(!E.isNullOrUndefined(t.search))return d&&(e.hostname=e.host=v.shift(),(w=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=w.shift(),e.host=e.hostname=w.shift())),e.search=t.search,e.query=t.query,E.isNull(e.pathname)&&E.isNull(e.search)||(e.path=(e.pathname||"")+(e.search||"")),e.href=e.format(),e;if(!v.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var m=v.slice(-1)[0],h=(e.host||t.host||1<v.length)&&("."===m||".."===m)||""===m,y=0,b=v.length;0<=b;b--)"."===(m=v[b])?v.splice(b,1):".."===m?(v.splice(b,1),y++):y&&(v.splice(b,1),y--);if(!p&&!g)for(;y--;)v.unshift("..");!p||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),h&&"/"!==v.join("/").substr(-1)&&v.push("");var w,h=""===v[0]||v[0]&&"/"===v[0].charAt(0);return d&&(e.hostname=e.host=!h&&v.length?v.shift():"",(w=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=w.shift(),e.host=e.hostname=w.shift())),(p=p||e.host&&v.length)&&!h&&v.unshift(""),v.length?e.pathname=v.join("/"):(e.pathname=null,e.path=null),E.isNull(e.pathname)&&E.isNull(e.search)||(e.path=(e.pathname||"")+(e.search||"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},x.prototype.parseHost=function(){var t=this.host,e=r.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":58,punycode:51,querystring:54}],58:[function(t,e,n){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}]},{},[1]);
//# sourceMappingURL=client.map